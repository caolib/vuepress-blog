---
title: 计算机网络
date: 2023-10-26 21:04:32
categories: 考研
tags:
  - 计算机网络
cover: https://img2.imgtp.com/2024/04/26/bIFqmrVZ.jpeg
sticky: 9999
---

# 计算机网络

<a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Cascadia+Code&weight=900&size=60&duration=2000&pause=1000&center=true&vCenter=true&random=false&width=1000&height=100&lines=Computer+Network+" alt="Typing SVG" /></a>

## 1. 计算机网络概述

### 1.1 计网的组成

#### 概念

简单定义：**硬件**(独立和连接)+**软件**(协议)+**目的**(共享和通信)

> **计算机网络就是以传输信息为基本目的,用通信线路和通信设备将多个计算机连接起来的计算机系统的集合**

![CopyQ.XjcbYs](https://img2.imgtp.com/2024/04/06/8bp2LLjc.png)

#### 分类

> 按网络**覆盖范围**进行分类

1. **局域网**(Local Area Network,`LAN`,一个实验室、一幢楼、一个校园)
2. **城域网**(Metropolitan Area Network,`MAN`,几个街区甚至整个城市,5-50 km)
3. **广域网**(Wide Area Network,`WAN`,覆盖一个国家或地区甚至几个洲,也称为**远程网**)
4. **个人区域网**(Personal Area Network,`PAN`,10 m以内)

> 按网络的**使用者**进行分类

1. **公用网**(所有愿意缴纳费用的人都能使用)
2. **专用网**(专门为本单位的特殊业务工作建造的,例如,军队、铁路、电力等系统)

<img src="https://img2.imgtp.com/2024/04/04/Nqa5DJOR.png" alt="计算机网络分类" title='计算机网络的分类' />

#### 组成

##### 组成部分

> 计算机网络主要由**硬件**、**软件**、**协议**组成

![image-20240406104102808](https://img2.imgtp.com/2024/04/06/2ynHlxA5.png)

##### 工作方式

从**工作方式**上看,计算机网络可分为：

1. **边缘部分**：用户直接使用的
2. **核心部分**：为边缘部分提供服务的

<img src="https://img2.imgtp.com/2024/04/04/zI8FwGzp.png" title="woc,O" style="zoom: 67%;" />

##### 逻辑功能

从逻辑功能上看,计算机网络由通信子网和资源子网组成

- **通信子网**：由各种**传输介质**、**通信设备**和相应的**网络协议**组成
- **资源子网**：实现资源共享功能的**设备**及其**软件**的集合

![image-20240404154608008](https://img2.imgtp.com/2024/04/04/sT1JdhEz.png)

### 1.2 功能

![image-20240406104955734](https://img2.imgtp.com/2024/04/06/fIl3XYce.png)

### 1.3 互联网

#### 网络的网络

1. 网络

> **网络**由若干**节点**(Node)和连接这些节点的**链路**(Link)组成
>
> 节点：可以是计算机、集线器、交换机、路由器

<img src="https://img2.imgtp.com/2024/04/04/84kZGy2h.png" title="网络" style="zoom:80%;" />

2. **互连网络**(`internet`,通用名词,<span style="color:#ff6b6b;font-weight:bold;font-size:20px">注意和 互联网Internet 区分</span>)

> 将网络用路由器连接起来就成了互连网络,因此互连网络是**网络的网络**

<img src="https://img2.imgtp.com/2024/04/04/QuZM13pW.png" title="互连网络就是网络的网络" style="zoom:80%;" />

> 总结：**网络把许多计算机连接在一起,而互连网络则把许多网络连接在一起**

3. **互联网**(Internet,也称 因特网)

> 当前全球最大的、开放的、由众多网络相互连接而成的特定计算机网络,**采用TCP/IP协议作为通信规则**,前身是美国的阿帕网`ARPANet`

#### 互联网结构发展

1. 第一阶段：从单个网络`ARPANET`向互连网络发展

2. 第二阶段：逐步建成三级结构的互联网

3. 第三阶段：逐渐形成多层次的[^ISP]结构的互联网

   

<img src="https://img2.imgtp.com/2024/04/04/2jKLXwuK.png" title="ISP结构的互联网" style="zoom: 67%;"/>

### 1.4 [电路、报文、分组交换](https://www.bilibili.com/video/BV19E411D78Q?t=0.0&p=4)

#### 电路交换

> 电路交换是指在通信开始之前,建立一条专用的**物理连接**,然后在通信过程中**一直占用这条连接**,直到通信结束。在这个过程中,数据被分成固定大小的数据包,每个数据包都被分配一个专用的物理通路,**适用于低频次、大量地传输数据**

![电路交换](https://img2.imgtp.com/2024/04/04/6OxFTe0R.png)

> 这种必须经过 1.**建立连接**(分配通信资源) 2.**通信**(一直占用通信资源) 3.**释放连接**(归还通信资源)三个步骤的交换方式称为电路交换
>
> 优点：通信**时延小**、**有序传输**、**没有冲突**、传输**速度快**、**控制简单**等
>
> 缺点：
>
> - **建立/释放连接**都需要**额外的时间开销**
>- **线路**被通信双方<span style="color:#ff6b6b;font-weight:bold">独占</span>,**利用率低**
> - **线路分配**的**灵活性差**(某段线路出现错误时只能重新建立连接)
>- 交换节点**不支持“差错控制”**(无法发现传输过程中的发生的数据错误)
> 
><span style="color:#ff6b6b;font-weight:bold;font-size:18px">总结</span>:计算机之间数据往往是“**突发式**”传输,即往往会**高频次、少量**地传输数据,所以电路交换并不适用于计算机网络

#### 报文交换

> 我们通常把要发送的整块数据称为一个**报文(Message)**,**用户数据**加上**源地址**和**目的地址**等信息后封装成报文,报文交换采用**存储转发**技术,整个报文传送到相邻结点,全部存储下来后查找**转发表**,转发到下一个结点,直到到达目的地

<img src="https://img2.imgtp.com/2024/04/04/RQWjb8wd.png" alt="image-20240404145149676" style="zoom:80%;" />

> 优点：
>
> - 通信前**无需建立连接**
> - 数据以“**报文**”为单位被交换节点间“**存储转发**”,通信**线路可以灵活分配**
> - 在通信时间内,两个用户无需独占一整条物理线路。相比于电路交换,**线路利用率高**
> - 交换节点支持“**差错控制**”(通过校验技术)
>
> 缺点：
>
> - 报文不定长,<span style="color:#ff6b6b;font-weight:bold;">不方便存储转发管理</span>
> - 长报文的<span style="color:#ff6b6b;font-weight:bold;">存储转发时间开销大、缓存开销大</span>
> - <span style="color:#ff6b6b;font-weight:bold;">长报文容易出错,重传代价高</span>(报文出错且校验技术无法修复时需要重传,报文越长越明显)



#### **分组交换**

> 分组交换：发送报文之前,**先将报文划分为一个个更小的等长的数据段**,在数据段前面加上**首部**(又称为包头)就构成了**分组**(又称为包),每个分组都带有**目标地址**和**源地址**等信息,然后通过网络传输。在传输过程中,每个数据包都独立传输,**可以通过不同的路径**到达目的地

<img src="https://img2.imgtp.com/2024/04/04/8SrtXoUf.png" alt="分组交换" style="zoom: 80%;" />

> 分组交换的优点：
>
> - 通信前**无需建立连接**
> - 数据以“**分组**”为单位被交换节点间“**存储转发**”,通信线路可以**灵活分配**
> - 在通信时间内,两个用户**无需独占**一整条物理线路。相比于电路交换,**线路利用率高**
> - 交换节点**支持“差错控制”**(通过校验技术)
>
> 相比于报文交换,分组交换改进了如下问题：
>
> - **分组定长,方便存储转发管理**
> - 分组的**存储转发时间开销小、缓存开销小**
> - 分组**不易出错,重传代价低**
>
> 分组交换的缺点：
>
> - 相比于报文交换,**控制信息占比增加**
> - 相比于电路交换,**依然存在存储转发时延**
> - 报文被拆分为多个分组,传输过程中可能出现**失序、丢失**等问题,**增加处理的复杂度**

**3种交换方式的对比**

![交换方式对比](https://img2.imgtp.com/2024/04/04/7G4LaEvx.png)

<div style="text-align: center;">
    <span style="color:#ff6b6b;font-weight:bold;font-size:25px;">总结：现代计算机网络采用分组交换技术</span>
</div>
### 1.5 计网的主要性能指标

#### 1. 速率

> 1. 数据的传输速率,也称为数据率、比特率 1字节(byte)=8比特(bit)
>
> 2. 单位是 `bit/s 或 bps` ,比特是数据量的单位,是一个二进制数字(0或1)
>
> 3. 一般来说,表示**速率**时$K = 10^{3}$,表示**存储容量或文件大小**时$k = 2^{10}$
> 

<img src='https://img2.imgtp.com/2024/04/04/0oBrmEnl.png' alt='速率'>

#### 2. 带宽

1. 带宽本来是指某个信号具有的频带宽度,表示通信线路允许通过的信号频带范围,单位为赫兹

2. 计算机网络中,带宽表示网络某通道传输能力,即最高数据率,单位为比特每秒(bit/s)

   <img src="https://img2.imgtp.com/2024/04/04/HNs5KlGu.png" alt='带宽'/>

#### 3. 吞吐量

> 也称为吞吐率,表示单位时间内通过某个网络(或信道、接口)的数据量

#### 4. 时延

> 时延是指数据从网络的一端传送到另外一端所需要的时间,也称为延迟或迟延
>
> 网络中的时延通常由以下几个不同的部分组成：
>
> 1. 发送时延：主机或路由器将整个分组的所有比特发送到通信线路上所需要的时间
>    $$
>    \text{发送时延} = \frac{\text{分组长度}}{\text{发送速率}}
>    $$
>
> 2. 传播时延：是电磁波在信道中传播一定距离所花费的时间
>    $$
>    \text{传播时延} = \frac{\text{信道长度}}{\text{电磁波在信道上的传播速度}}
>    $$
>
> 3. 处理时延：主机或路由器在收到分组时处理分组花费的时间(一般不方便计算)

<img src="https://img2.imgtp.com/2024/04/04/3MPbeO6Z.png" alt='时延'/>

![时延](https://img2.imgtp.com/2024/04/04/ZdVAQDaU.png)

#### 5. 时延带宽积 往返时间 利用率 丢包率

<img src="https://img2.imgtp.com/2024/04/04/gJwUU2lk.png" alt="" style="zoom:;" />

### 1.6 **计算机网络体系结构**

#### 1.6.1 网络协议

网络协议主要由以下三要素组成：

1. **语法**：数据与控制信息的结构或格式(例如,地址字段多长以及它在分组的什么位置)
2. **语义**：各个控制信息的具体含义(需要发出何种控制信息、完成何种动作及做出何种响应)
3. **同步(时序)**：事件实现的顺序和时间的详细说明(数据何时发出以及以什么速率发出)

#### 1.6.2 分层体系结构

![常见的计算机网络分层体系结构](https://img2.imgtp.com/2024/04/04/k6fK6Fth.png)

#### 1.6.3 原理体系结构

> 我们学习的是具有五层协议的原理体系结构

![原理体系结构](https://img2.imgtp.com/2024/04/04/aWnMqDAo.png)

#### 1.6.4 实体、协议和服务

> **协议是水平的,服务是垂直的**
>
> 1. ==实体==：任何可发送或接收信息的硬件或软件进程
> 2. ==协议==：**控制两个或多个对等实体之间通信的规则的集合**
> 3. **下层通过层级接口向上层提供服务,下面的协议对上面的实体是”透明“的**
> 4. 透明：某个实际存在的事物看起来好像不存在一样

![实体、协议和服务](https://img2.imgtp.com/2024/04/04/QxFzryw5.png)

![1](https://img2.imgtp.com/2024/04/04/ZEjjP9Xe.png)

### 1.7 相关习题

![](https://img2.imgtp.com/2024/04/04/YMD1YO49.png)

![](https://img2.imgtp.com/2024/04/04/apY4UiGK.png)

### 1.8 思维导图和习题

1. [第1章 概述(思维导图)](https://www.kdocs.cn/view/l/cqzI95zH7t6v)
1. [第1章 概述 习题 (kdocs.cn)](https://www.kdocs.cn/view/l/cmCC5Updax17)

---

## 2. 物理层

> **任务：怎样在连接各种计算机的传输媒体上传输数据比特流**(使数据链路层感觉不到各种传输媒体之间的差异,只需要使用物理层服务就能传输比特流,不必关心具体怎么实现)

### 2.1 基本概念

![物理层的基本概念](https://img2.imgtp.com/2024/04/04/DwZwhVmK.png)

### 2.2 数据通信的基础知识

#### 通信系统模型

![](https://img2.imgtp.com/2024/04/04/RxOxpZHA.png)

#### 编码与调制

1. 定义

   - 模拟信号：消息的参数的取值是连续的
   - 数字信号：消息的参数的取值是离散的

   - 编码：将**数字数据转换成数字信号**的过程
   - 调制：将**数字数据转换成模拟信号**的过程

![编码与调制](https://img2.imgtp.com/2024/04/04/ACtS6JxY.png)

2. **常用编码方式**

![常用编码方式](https://img2.imgtp.com/2024/04/04/9MM2Ky5h.png)

3. 基本的调制方法

![基本的调制方法](https://img2.imgtp.com/2024/04/04/vAkWNODU.png)

4. **相位调制**

> **8相位调制**表示8种状态,只需要**3个比特**(二进制,$2^3=8$)即可,所以**1个码元可以承载3个比特**,**数据传输率 = 3*波特率**,以此类推

#### 信道的极限容量

![信号失真](https://img2.imgtp.com/2024/04/04/FXFhMUmi.png)

##### **奈式准则**

> 也称[**奈奎斯特定理**|**采样定理**],理想低通信道的最高码元传输速率 = $2*W$ 波特 = $2*W*\log_2{V}$​
>
> V：一个码元可以表示的离散电平数目
>
> W：频率带宽,最低和最高频率之差
>
> 理想低通信道：不考虑噪声



![奈式准则](https://img2.imgtp.com/2024/04/04/lU9RuLRg.png)

##### 香农公式

> **香农公式**
> $$
> c = W \cdot \log_{2}(1 + \frac{S}{N})
> $$
> 知道信噪比(dB)求S/N,假设信噪比为30dB
>
> 1. $$30 = 10 \cdot \log_{10}(\frac{S}{N})$$
> 2. $$3 = \log_{10}(\frac{S}{N})$$
> 3. $$\frac{S}{N} = 10^3$$

![香农公式](https://img2.imgtp.com/2024/04/04/x9dHMH8w.png)

> 1. 在信道带宽一定的情况下,根据奈氏准则和香农公式,要想提高信息的传输速率就必须采用多元制(更好的调制方法)和努力提高信道中的信噪比
> 2. 自从香农公式发表后,各种新的信号处理和调制方法就不断出现,其目的都是为了尽可能地接近香农公式给出的传输速率极限
> 3. 影响信号传输速率的因素：
>    - **信道带宽**
>    - **信噪比**
>    - **码元速率(调制速率)**

#### 传输方式

1. 并行传输和串行传输

> - 并行传输速度是串行传输的n倍,但是<span style="color:#ff6b6b;font-weight:bold">成本高</span>所以**长距离传输使用串行传输**
> - 远距离传输使用串行传输,**计算机内部使用并行传输**

![并行传输和串行传输](https://img2.imgtp.com/2024/04/04/ObkVayAR.png)

2. 异步传输和同步传输

> 异步传输字节之间异步,但是要添加开始码和停止码作为引导

<img src="https://img2.imgtp.com/2024/04/04/60wDHc1z.png" alt="异步传输和同步传输"  />

3. 单工、半双工和全双工通信

![单工、半双工和全双工通信](https://img2.imgtp.com/2024/04/04/SnlGXRdp.png)

### 2.3 物理层传输介质

#### 导引型介质

1. **同轴电缆**

![同轴电缆](https://img2.imgtp.com/2024/04/04/UAaTjOr4.png)

2. **双绞线**

![双绞线](https://img2.imgtp.com/2024/04/04/CGI4fSr6.png)

3. **光纤**

- 多模光纤：利用光的**全反射特性**,光源使用**发光二极管**,适合**近距离传输**
- 单模光纤：光纤直径减小到只有光的一个波长,可使光线**直线传播**,光源使用**半导体激光器**,适合**远距离传输**,但是<span style="color:#ff6b6b;font-weight:bold">成本较高</span>

![光纤](https://img2.imgtp.com/2024/04/04/VE3yDe2c.png)

#### 非导引型介质

1. **微波**:有很强的**方向性**

![微波](https://img2.imgtp.com/2024/04/04/CkEx8Sjz.png)

2. **无线电波**:有较强的穿透能力,可以传输很长距离,**信号向所有方向传播**,广泛用于通信领域(`WLAN`)
3. 红外线和可见光



#### **物理层接口的特性**

1. 机械特性：指名接口所用接线器的**形状**和**尺寸**、**引脚数目**和**排列**、**固定**和**锁定装置**等
2. 电气特性：指名在接口电缆的各条线上的**电压范围**、**传输速率**和**距离限制**等
3. 功能特性：指名某条线上出现某一电平的**电压的意义**,以及**每条线的功能**
4. 过程特性：也称规程特性,指名对不同功能的各种可能事件的**出现顺序**

------

### 2.5 物理层设备

#### **中继器**

- **功能**:对信号进行**再生和还原**,**对衰减的信号进行放大**,保持与原数据相同(**不能检测出信号是否错误**),以增加信号传输的距离,延长网络的长度
- 中继器有**2个端口**,两端是网段而非子网,适用于**完全相同的两类网络(速率、协议等)**的互联

- `5-4-3`规则：网络标准中都对信号的延迟范围作了具体的规定,因而中继器只能在规定的范围内进行,否则会网络故障,下图中5段链路使用4个中继器连接,最多允许3台主机

  ![image-20240404212316193](https://img2.imgtp.com/2024/04/04/9JCU8e1K.png)

#### **集线器**

> **集线器相当于多端口中继器**

- **功能**:对信号**再生放大转发**
- 有**1个输入**端口和**多个输出**端口,**不具备定向转发**信号功能,是一个共享性设备,**不能分割冲突域**
- 有多台设备共享时,带宽均分给各个设备

![image-20240404213049374](https://img2.imgtp.com/2024/04/04/Ac4qbmev.png)

### 2.6 相关习题和资料

1. [第2章 物理层 习题](https://www.kdocs.cn/view/l/cfixYkxNJ7Ep)
2. [第2章 物理层(思维导图)](https://www.kdocs.cn/view/l/ckmnMjp5UQvK)

---

## 3. 数据链路层

![image-20240409202339726](https://img2.imgtp.com/2024/04/09/ecaBaiM8.png)

> **任务：解决数据包在一个网络或一段链路上传输的问题**
>
> **功能**：
>
> - 为网络层提供服务:1.无确认无连接服务2.有确认无连接服务3.有确认面向连接服务 (面向连接一定有确认!)
> - 链路管理,即连接的建立、维持、释放(用于面向连接的服务)
> - **封装成帧**
> - **流量控制**(限制发送方)
> - **差错控制**(帧错/位错)

### 3.1 相关概念

> - **链路(Link)**网络中两个节点之间的<span style="color:#ff6b6b;font-weight:bold;">物理线路</span>,而中间没有任何其他的交换节点
> - **数据链路(Data Link)**网络中两个节点之间的<span style="color:#ff6b6b;font-weight:bold;">逻辑线路</span>,把实现**控制数据传输协议的硬件和软件**加到链路上就构成数据链路
> - **网络适配器(俗称网卡)**和其相应的软件驱动程序就实现了这些协议,一般的网络适配器都包含了物理层和数据链路层这两层的功能
> - **帧(Frame)**是**数据链路层的协议数据单元**,封装网络层数据报

### 3.2 封装成帧和透明传输

#### 1.封装成帧

> 1. **封装成帧**(组帧)就是在一段数据的前后部分**添加首部和尾部**,这样就构成了一个**帧**。
>
> 2. 首部和尾部包含许多的控制信息,他们的一个重要作用：**帧定界**(确定帧的界限)。
> 3. **帧同步**：接收方应当能从接收到的二进制比特流中**区分出帧的起始和终止**
> 4. **组帧**的四种方法：
>    - 字符计数法
>    - **字符(节)填充法**
>    - **零比特填充法**
>    - **违规编码法**

![封装成帧](https://img2.imgtp.com/2024/04/04/xbX4Jkku.png)

#### <span style = 'color:#ff6b6b'>2.透明传输问题</span>

> **透明传输**：<span style="color:#ff6b6b;font-weight:bold;">数据链路层对上层交付的PDU的内容没有任何限制,就好像数据链路层不存在一样</span>
>
> **透明传输问题**：上层应用交付的数据单元中可能含有**和帧定界符相同的数据**而被接收端**误认为帧定界符**从而导致错误

<img src="https://img2.imgtp.com/2024/04/04/7EkRy4M8.png" alt="透明传输问题"  />

#### 3.组帧

> 如果不解决透明传输问题,则数据链路层就会**对上层交付的PDU的内容有所限制**,即<span style="color:#ff6b6b;font-weight:bold;">PDU中不能包含帧定界符</span>。显然,这样的数据链路层没有什么应用价值

1. 字符计数法

> 原理：在帧的首部用一个**计数字段**来记录**当前帧的所含的字节数**(包含自身的1个字节),接收方读取到帧的首部中的计数字段就能**确定该帧的长度并定界**
>
> 问题：如果<span style="color:#ff6b6b;font-weight:bold;">计数字段错误</span>,会导致<span style="color:#ff6b6b;font-weight:bold;">当前帧的定界错误</span>,从而<span style="color:#ff6b6b;font-weight:bold;">导致下一个帧的定界也出错</span>,接受双方将<span style="color:#ff6b6b;font-weight:bold;">失去同步</span>,造成<span style="color:#ff6b6b;font-weight:bold;font-size:20px;">灾难性后果!</span>

![字符计数法](https://img2.imgtp.com/2024/04/10/T1nEmnkf.png)

2. **字符(节)填充法**

> 原理:发送方在发送数据前,如果待发送数据中**含有和帧定界符相同的数据**,在该数据**前加一个转义字符ESC**,如果数据中出现其他特殊字符(ESC字符)处理方式相同; 接收方在接收数据时如果**读取到了ESC字符**,则认为后面紧跟着的**是数据**而**不是特殊字符**

![字符填充](https://img2.imgtp.com/2024/04/04/1iuGNypX.png)

对于字符填充,举个不恰当的例子,如果我们要输出的字符串中带有`“`,就必须使用`\`进行转义,否则会出现语法错误

```python
print(" \" ")
```

3. **零比特填充**

> 发送方：扫描要发送的信息,<span style="color:#ff6b6b;font-weight:bold;">如果有连续的5个1,立即插入1个0</span>,接收端逆操作即可(`01111110`为帧定界符)
>
> 接收方：在接收端收到一个帧时,先找到标志字段确定边界,再用硬件对比特流进行扫描,**发现连续5个1时,就把后面的0删除**
>
> 总结：**保证了透明传输,在传送的比特流中可以传送任意比特组合,而不会引起对帧边界的判断错误**

![零比特填充](https://img2.imgtp.com/2024/04/04/Wc2JZvjx.png)

4. **违规编码法**

> 以曼彻斯特编码为例,曼彻斯特编码**中间时刻必定跳变**(电平对为[高-低]或[低-高]),所以可以**使用不跳变表示帧的界,使用[高-高]表示帧的开始,使用[低-低]表示帧的结束**
>
> 违规编码法**不采用任何填充技术**便能实现数据的透明传输,但只适用于采用**冗余编码**的特殊编码环境

![image-20240409222701713](https://img2.imgtp.com/2024/04/09/H8LbiLki.png)

> <span style="color:#ff6b6b;font-weight:bold;font-size:18px">总结</span>:由于字节计数法中count字段的**脆弱性**(其值若有差错将导致灾难性后果)及字符填充实现上的复杂性和不兼容性(非`ASCII`字符不太适用),**目前较普遍使用的帧同步法是比特填充法和违规编码法**

### 3.3 差错控制

> **全局性**：由于线路本身电气特性所产生的**随机噪声**(热噪声),是信道固有的,随机存在的。解决办法：提高信噪比来减少或避免干扰。(对传感器下手)
>
> **局部性**：外界特定的短暂原因所造成的**冲击噪声**,是产生差错的主要原因。解决办法：通常利用编码技术来解决。
>
> 差错：
>
> 1. **位错**：比特位出错,1变成0,0变成1
> 2. **帧错**：丢失、重复、失序

#### 检错编码

##### 奇偶校验码

> 奇偶校验码：是奇校验和偶校验的统称,在待发送**数据后加一位校验码(0/1)**,使整个数据中`1`的个数为奇数个(奇校验)或者偶数个(偶校验)
>
> 特点：**只能检查出奇数个比特错误**,但不知道哪些位错了,检错能力为50%

![image-20240410090104759](https://img2.imgtp.com/2024/04/10/K7xxxKVB.png)

##### **循环冗余码**

> CRC检验广泛使用于数据链路层,**CRC是具有纠错功能的**,只是数据链路层仅仅使用了它的检错功能
>
> 收发双方需要约定一个**生成多项式**(最高位和最低位必须为1)
>
> 计算出的冗余码(**帧检验序列FCS**)加到数据最后一起传输
>
> FCS生成和CRC检验都是**由硬件完成**,处理非常迅速

![CRC](https://img2.imgtp.com/2024/04/04/LqnKVXNU.png)

**发送方**

> 下图生成多项式$x^3+x^2+1$ =>  <span style="color:#ff6b6b;font-weight:bold;">1</span>$ \cdot x^3+$<span style="color:#ff6b6b;font-weight:bold;">1</span>$ \cdot x^2+$<span style="color:#ff6b6b;font-weight:bold;">0</span>$ \cdot x+$<span style="color:#ff6b6b;font-weight:bold;">1</span>$ \cdot x^0$​ => 除数为`1101`
>
> **除法**：此处指**异或**运算

![CRC](https://img2.imgtp.com/2024/04/04/yzlERye7.png)

**接收方**

![](https://img2.imgtp.com/2024/04/04/iEc5Y2da.png)

<span style="color:#ff6b6b;font-weight:bold;font-size:20px">检错码总结</span>

![](https://img2.imgtp.com/2024/04/04/kspkPie2.png)

#### 纠错编码

##### 汉明码

> **汉明码**(`Hamming Code`):又称为海明码,最常见的纠错编码

1. **确定校验位数**

> n为信息位数,r为校验位数,取使得等式成立的最小的r,**海明不等式**:
> $$
> 2^r \geq n+r+1
> $$
> $\text{海明码的位数} = \text{信息位数} + \text{校验位数}$

![image-20240412151532196](https://img2.imgtp.com/2024/04/12/au4gBf7Q.png)

2. **确定校验码和数据的位置**

> 校验码放在 $2^n$ 的位置上(第1、2、4、8……个)

![image-20240412151644361](https://img2.imgtp.com/2024/04/12/vlACsIY3.png)

3. **求出校验码的值**

> **分组**:第1个校验码中包括**序号二进制末尾为1**的数,第二个检验码中包括序号二进制为1的数,以此类推,同一个数可以分到多个组中,几个校验码就分几组
>
> **求值**:默认采用**偶校验**,保证每个组中1的个数为偶数个(如果1为奇数个,那么校验码为1,否则为0),也可以使用**异或运算**解决,校验码的值就是对应校验组所有数据异或运算的结果

![image-20240412180239878](https://img2.imgtp.com/2024/04/12/aYNBsfJM.png)

4. **检错并纠正**

> 检错：接收方接收到数据后将对应校验码和校验组所有数据进行异或运算,结果**应全部为0(偶校验)**,出现1说明出现了错误
>
> 纠错：各个组的异或结果应为000……,如果不全是0,**假设是101,那么出错的为就是异或结果的二进制位,即5**

![image-20240412181429972](https://img2.imgtp.com/2024/04/27/QmxDzrEi.png)



------

### 3.4 流量控制

#### 可靠传输

![](https://img2.imgtp.com/2024/04/04/bl3iFcsr.png)

![](https://img2.imgtp.com/2024/04/04/9kptbtUg.png)

#### 停止-等待协议(SW)

1. 基本原理

> 停止-等待协议(`S`top-and-`W`ait)
>
> - 发送一个数据分组`DATA0`然后**等待**接收方发来确认信息`ACK0`后再传输下一个数据分组`DATA1` (发送、接收窗口大小都为1)
>
> - 如果**超时**未接收到接收方发送的确认信息`ACK0`或者**接收到否认**信息`NAK`就重传上一个分组数据分组(发送方发送一个分组后不会立即删除该分组,因为可能需要重传,接收到[^ACK]后才将分组从缓存删除)
>
> - 数据分组和确认信息的**编号**都是用来**区分**和上一个分组或信息是否相同(SW协议编号只需要1个比特)

  <a href="https://www.bilibili.com/video/BV1c4411d7jb?t=48.2&p=25"><img alt="bili" src="https://img.shields.io/badge/SW-white?logo=bilibili&labelColor=white&color=%23fb7299"></a>

![SW](https://img2.imgtp.com/2024/04/04/kDCsZAbL.png)

2. **停止等待协议的信道利用率**

> $$
> \text{信道利用率}= \frac{\text{数据发送时延}}{\text{数据发送时延}+\text{2个传播时延}+\text{确认信息发送时延}}
> $$
>
> **确认信息的发送时延一般忽略不计**
>
> **总结：当往返时间远大于数据帧的发送时延时,<span style="color:#ff6b6b;font-weight:bold;">信道利用率很低</span>,如果出现超时重传,信道利用率更低**(卫星链路)

#### 回退N帧协议(GBN)

> 回退N帧协议(`G`o-`B`ack-`N`)
>
> 发送方可以在**未收到确认帧**的情况下将**发送窗口内的多个数据帧**全部发送出去
>
> 回退N帧的含义：发送方发送了N个帧,如果这**N个帧的前一个帧**在超时的时候仍未接收到确认分组,则认为该帧**出错或丢失**,此时,发送方需要**重传该出错帧及随后的N个帧**,因为该协议中<span style="color:#ff6b6b;font-weight:bold;">接收方只能顺序接受帧</span>
>
> GBN采用**累计确认**,假设发送方发送了10个数据(0-9),随后收到接收方发来的确认分组编号为6,这表示0-6号数据全部接收了,而不是仅仅对6号数据的确认

  <a href="https://www.bilibili.com/video/BV1c4411d7jb?t=81.1&p=26"><img alt="bili" src="https://img.shields.io/badge/GBN-white?logo=bilibili&labelColor=white&color=%23fb7299"></a>

![](https://img2.imgtp.com/2024/04/04/hB250oge.png)

![](https://img2.imgtp.com/2024/04/04/Ub9UUjBl.png)

> <span style="color:#ff6b6b;font-weight:bold;">GBN重点</span>：
>
> - **发送窗口**：如果采用了n个比特进行编号,那么发送窗口$W_T$满足$1<W_T<2^n-1$​,太大会造成接收方无法分辨新旧数据帧
>
> - **接收窗口**：$W_R = 1$​,可保证按序接收数据帧(**只能按序接收**)
>
> - 接收方**只按顺序接收帧**,不按序无情丢弃
> - **累积确认**(偶尔梢带确认),确认序列号最大的、按序到达的帧

#### 选择重传协议(SR)

>  选择重传协议(`S`elective `R`epeat):在GBN协议中,只要一个帧出错,该帧及其随后的所有帧都需要重传,这是对通信资源的极大浪费,为进一步提高信道利用率,可以**只重传出错或计时器超时的帧**,此时必须**加大接收窗口以便收下失序但正确到达的帧**
>
> <span style="color:#ff6b6b;font-weight:bold;">重点</span>：
>
> - SR接收方将确认一个正确接收的帧而不管其是否按序到达(失序的帧将被缓存)
> - **不能使用累计确认,对每个帧都进行确认**
> - 接收方有缓存
> - **发送窗口$1<W_T<2^{n-1}$,接收窗口$1<W_R<W_T$**

<a href="https://www.bilibili.com/video/BV1c4411d7jb?t=9.1&p=27"><img alt="bili" src="https://img.shields.io/badge/SR-white?logo=bilibili&labelColor=white&color=%23fb7299"></a>

![](https://img2.imgtp.com/2024/04/04/lTKxaOpK.png)

------


> 总结：ARQ(自动重传请求)协议包括三种：停止-等待(SW)协议、后退N帧(GBN)协议、选择重传(SR)协议。**GBN、SR为连续ARQ协议**,可以连续发送多个帧。
>
> **连续ARQ的信道利用率**,假设发送窗口为`n`,即发送方可以连续发送的帧的数量
>
> 信道利用率U为
> $$
> U = \frac{nT_D}{T_D+RTT+T_A}
> $$
> 信道实际数据传输速率 = 信道利用率 × 信道带宽



------

### 3.5 介质访问控制

#### 1.通信方式

数据链路层的通信方式

![image-20240413114302558](https://img2.imgtp.com/2024/04/13/qREqa6zW.png)

#### 2.介质访问控制

![image-20240420110848013](https://img2.imgtp.com/2024/04/20/YJFtawLv.png)

#### 3.信道划分

> 复用：当网络中传输媒体的传输容量大于多条单一信道传输的总通信量时,可利用复用技术**在一条物理线路上建立多条通信信道来共享传输媒体的带宽**

<img src="https://img2.imgtp.com/2024/04/04/ClYKHJq5.png" alt="信道复用" style="zoom:80%;" />

##### 1. 频分复用

> **频分复用**(Frequency-division multiplexing,`FDM`):将多路基带信号调制到不同频率载波上,再进行叠加形成一个复合信号,接收端的分用器通过滤波将各路信号滤出,将合成的复合信号恢复成原始的多路信号,**信道利用率高**
>
> 实际应用中,为了防止信道之间相互干扰,相邻信道间还要加入“隔离频带”

![image-20240413115640153](https://img2.imgtp.com/2024/04/13/9tcFG4HL.png)

##### 2. 时分复用

> 时分复用(Time Division Multiplexing,`TDM`)：将传输线路的带宽资源**按时间轮流分配给不同的用户**,用户只能在分配的时间里使用线路传输数据(类似于时间片轮转),**同一时刻只有一个用户在使用**,相当于多个用户并发使用
>
> 存在的**不足**：使用时分复用系统传送计算机数据时,由于计算机数据的突发性质,用户对分配到的**子信道的利用率一般不高**(如果B暂时不使用信道,其他用户正常使用,时分复用还是会给B分配时间,而且这段时间内其他用户也不能使用)
>
> **图中第2个周期第2段时间中<span style="color:#e6e600;font-weight:bold;">黄色线</span>并没有使用信道,但还是会分配信道给他,而且该时间段内其他用户不能使用**

![image-20240413124732334](https://img2.imgtp.com/2024/04/13/GqvfdyNg.png)

> **统计时分复用**(statistical time division multiplexing,`STDM`):动态地按需分配共用信道的时隙,**只将需要传送数据的终端接入共用信道**,可以提高信道的利用率
>
> 帧与帧之间留有**空隙**用来存储用户的地址信息,因为**不是固定的分配给某个用户**

![image-20240413131118032](https://img2.imgtp.com/2024/04/13/3tBMGXBQ.png)

##### 3. 波分复用

> 波分复用(Wavelength Division Multiplexing,`WDM`)就是**光的频分复用**(专指**光纤**),使用一根光纤来同时传输多个光载波信号,现在已能做到在一根光纤上复用几十路或更多路数的光载波信号

![波分复用](https://img2.imgtp.com/2024/04/04/wmz4xQ8u.png)

##### 4. 码分复用

> - **码分多路复用**(Code Division Multiplexing,`CDM`)：又叫**码分多址**`CDMA`(Code Division Multiple Access),采用不同的编码(地址码)来区分各路原始信号的一种复用方式
> - 它**既共享信道的频率,又共享时间**,是真正意义的动态复用技术
> - 最初用于军事,因为这种系统发送的信号**有很强的抗干扰能力**,其频谱类似于白噪声,不易被敌人发现

![码分复用](https://img2.imgtp.com/2024/04/04/jr9xumaq.png)

> 1. **码片序列转为码片向量**(0->-1,1->+1),例：码片序列为(1101) -> 码片向量为(+1,+1,-1,+1) 
>
> 2. **如果有多个站同时发送信号,将它们的码片向量线性相加**
>
> 3. 接收方收到总信号,如果想知道A站发送的信息就可以**用A站的码片向量与总信号规格化内积** $\text{规格化内积} = \frac{\text{向量相乘}}{\text{向量个数}}$
>
>    - **内积为1  -> A站发送信号1** 发送的是自己的**码片序列**
>
>    - **内积为0  -> A站未发送信号** 未发送数据
>
>    - **内积为-1 -> A站发送信号0** 发送的是自己的**码片序列的二进制反码**

------

#### 4.随机访问

##### 概述

> 在随机访问协议中,所有用户可以根据自己意愿发送信息,那么在总线型网络中,当有多个用户同时发送数据时,就会产生**帧冲突**(碰撞),导致所有冲突的用户的发送都以失败告终,**随机访问介质访问控制协议**(争用性协议)的核心思想是：**胜利者通过争用获得信道**,进而获得发送权

##### 1. ALOHA 协议

> **纯 [^ALOHA] 协议**：<span style="color:#ff6b6b;font-weight:bold;">想发就发</span>,发生冲突等待**随机时间**后重传,容易出现冲突,**效率较低**
>
> **时隙 ALOHA 协议**：将时间分成相同大小的**时间片**,只有在<span style="color:#ff6b6b;font-weight:bold;">时间片开始的时候</span>才能发送,**发送一帧的时间不能超过一个时隙**,一定程度上限制了发送方发送数据的随意性,降低了冲突的概率(依然很大),产生冲突后等待**随机个时隙**时间后重传

![image-20240417220719723](https://img2.imgtp.com/2024/04/17/RtFprUL8.png)

##### 2. CSMA 协议

> **CSMA(Carrier Sense Multiple Access)载波监听 多路访问**

![image-20240420091922904](https://img2.imgtp.com/2024/04/20/gCZW2TEK.png)

<span style="color:#ff6b6b;font-weight:bold;">总结</span>

|      | 1-坚持CSMA |                          非坚持CSMA                          |              P-坚持CSMA               |
| :--: | :--------: | :----------------------------------------------------------: | :-----------------------------------: |
| 空闲 |  立即发送  |                           立即发送                           | **p概率发送,1-p概率推迟到下一个时隙** |
|  忙  |  持续监听  | <span style="color:#ff6b6b;font-weight:bold;">放弃监听</span>,等待随机时间继续监听 |  **持续监听(等到下一个时隙再监听)**   |

> p-坚持CSMA只适用于**时分信道**,检测到**信道空闲时以概率p发送数据**,以概率1-p**推迟到下一个时隙继续监听**
>
> 1-坚持CSMA监听到信道忙时会**持续监听信道,出现冲突时才会等待随机时间后再监听**

##### 3. **CSMA/CD 协议**

> **CSMA/CD(Carrier Sense Multiple Access/collision detection)载波监听 多路访问/碰撞检测**
>
> 在CSMA中<span style="color:#ff6b6b;font-weight:bold;">尽管发生冲突,数据还是会继续传输完毕</span>,这是不必要的(发生冲突后传输的数据已经无效)
>
> CSMA/CD 的工作流程可以概括为“先听后发,**边听边发,冲突停发**,随机重发”,**在发送数据时一边监听信道,如果发生冲突立即停止发送**(主要区别)

###### 工作流程

![](https://img2.imgtp.com/2024/04/04/ED5B2K8l.png)

###### **争用期**

> **2τ** ,即**端到端传播时延的2倍**,10BaseT以太网中规定争用期为51.2μs

![](https://img2.imgtp.com/2024/04/04/pcp1O29f.png)

###### **最小帧长**

>**最小帧长 = 争用期 x 数据传输速率**
>$$
>l = 2τ * \text{数据传输速率} = 2*\frac{\text{距离}}{\text{传播速率}}*\text{数据传输速率}
>$$

![](https://img2.imgtp.com/2024/04/04/TctW8FkX.png)

###### **二进制指数退避算法**

> 发生碰撞后进行重传,随着重传次数增加,退避时间也会逐渐增加,减小了碰撞的概率

![image-20231103163318636](https://img2.imgtp.com/2024/04/04/vzrGh2uB.png)



##### 4. **CSMA/CA**

> **CSMA/CA(Carrier Sense Multiple Access with Collision Avoid)载波监听、多路访问/碰撞避免**

![](https://img2.imgtp.com/2024/04/04/CT1N67Ir.png)

> 碰撞避免实现中涉及的的三种机制：
>
> 1.预约信道：通知其它站点，自己需要的时间长度
>
> 2.ACK帧：接收站点发回确认；发送端超时未接收ACK则重发
>
> 3.`RTS`(Request To Send) 帧与`CTS`(Clear To Send)帧(可选)：发送端发RTS，接收端响应CTS，发送端收到CTS则认为可以发送数据，**CTS帧的目的：1.给源站明确的发送许可 2.指示其他站在预约期间不要发送**
>
> **帧间间隔**(InterFrame Space IFS):所有站发送一帧后必须等待一段很短的时间(帧间间隔)才能继续监听并发送数据，IFS的类型：
>
> - `SIFS`(短) 最短的IFS，用于分隔一次对话的各帧(ACK、CTS等)
> - `PIFS`(点协调) 中等长度的IFS，在PCF操作中使用
> - `DIFS`(分布式协调) 最长的IFS，用于异步帧竞争访问的时延

#### 5.轮询访问

> 用户不能随机发送数据，而是通过一个集中控制的监控站，以循环方式轮询访问每个结点，再决定信道的分配，典型的轮询访问控制协议是令牌传递协议

##### 令牌传递协议

![image-20240420110009790](https://img2.imgtp.com/2024/04/20/meVU77Xe.png)

> 注意点：
>
> - 网络空闲时，只有**令牌帧在循环传递**(游荡)
> - 源站点传输完数据后，**重新生成一个令牌**并传递给下一个站点
> - 令牌传递协议适合**负载较重、通信量较大**的广播信道
> - <span style="color:#ff6b6b;font-weight:bold;">单点故障会导致整个网络无法工作</span>(逻辑上环形)

### 3.6 局域网

#### 概述

![image-20240420113134042](https://img2.imgtp.com/2024/04/20/ZLZC4JJA.png)

#### 拓扑结构

![](https://img2.imgtp.com/2024/04/20/reb0noqv.png)

#### 分类

> 1. 以太网以太网是应用最为广泛的局域网，包括标准以太网（10Mbps）、快速以太网（100Mbps）千兆以太网（1000Mbps）和10G以太网，它们都符合IEEE802.3系列标准规范。**逻辑拓扑总线型，物理拓扑是星型**或拓展星型,使用CSMA/CD
>
> 2. 令牌环网**物理上采用了星形拓扑结构，逻辑上是环形拓扑结构**。已是“明日黄花”
>
> 3. FDDl网 （Fiber Distriouted Data Interiace)**物理上采用了双环拓扑结构，逻辑上是环形拓扑结构**
> 4. ATM网 (Asynchronous Transier Mode)较新型的单元交换技术，使用53字节固定长度的单元进行交换
>
> 5. 无线局城网（WIrelessLocalAreaNetworkWLAN）采用IEEE802.11标准

![局域网的分类](https://img2.imgtp.com/2024/04/27/KUOQpahI.png)

> 以太网支持全双工和半双工通信，**全双工不使用CSMA/CD协议(无冲突)**，半双工通信方式可能发生冲突，使用CSMA/CD协议 [**10吉比特以太网只能全双工**]

100BaseT以太网

![image-20240420125317777](https://img2.imgtp.com/2024/04/20/51qnZW5A.png)

MAC子层

![image-20240420141212069](https://img2.imgtp.com/2024/04/20/gJBMwlkd.png)

#### MAC地址

1. **MAC地址**是对网络上**各接口的唯一标识**,而不是对网络上各设备的唯一标识(**路由器有多个接口,所以有多个MAC地址**)

![](https://img2.imgtp.com/2024/04/04/68avB7T3.png)

2. MAC地址格式

![](https://img2.imgtp.com/2024/04/04/BNjnFpPt.png)

3. MAC帧有三种：单播、广播、多播

> 单播帧：一对一

![](https://img2.imgtp.com/2024/04/04/D6d0SVGo.png)

> 广播帧：一对全体
>
> 广播地址：**FF-FF-FF-FF-FF-FF**

![](https://img2.imgtp.com/2024/04/04/TfVVC54V.png)

> 多播帧：一对多
>
> 多播地址：**第二个数是奇数**代表是多播地址

#### VLAN

> 虚拟局域网(`Virtual Local Area Network`,VLAN)是一种将局域网内的站点划分成与物理位置无关的逻辑组的技术,一个逻辑组就是一个VLAN,VLAN中的各站点具有某些共同的应用需求
>
> **广播风暴**：<span style="color:#ff6b6b;font-weight:bold;">广播风暴会浪费网络资源和各主机的CPU资源</span>
>
> - 可以**使用路由器切割广播域**,防止广播风暴,但是成本较高
> - 使用**vlan技术划分广播域**
>
> 注意点：
>
> - `A`发送广播帧,`Access`接口接收并**打标签**,`PVID`和`VID`相同的Access端口可以接收该帧,进行去标签转发
>
> - `Trunk`端口的`PVID`如果等于该帧的`VID`,也会先去标签转发,然后再打标签,否则直接转发
> - **Trunk端口是连接两个交换机的**
> - 插入VLAN标签的帧称为802.1Q帧，首部添加4字节，最大帧长增加为1522字节

![](https://img2.imgtp.com/2024/04/04/XkiEONEm.png)

------

### 3.7 广域网

#### 概述

![image-20240420131312782](https://img2.imgtp.com/2024/04/20/V6rN5owV.png)



#### **PPP 协议**

1. 概述

> 点对点协议(`Point-to-Point Protocol`,PPP)是目前使用最广泛的**点对点数据链路层协议**,
>
> PPP协议的3个组成部分：
>
> 1. 一个将IP数据报封装到串行链路的方法
> 2. 网络控制协议NCP:PPP可支持多种网络层协议，每个不同的网络层协议都要一个相应的NCP来配置，为网络层协议建立和配置逻辑连接
> 3. 链路控制协议LCP：建立并维护数据链路连接(身份验证)

![PPP](https://img2.imgtp.com/2024/04/04/oEvbpogl.png)

2. PPP的帧格式

![](https://img2.imgtp.com/2024/04/04/rpgHWbjQ.png)

3. PPP的透明传输

> 异步传输：字符填充
>
> 同步传输：0比特填充

![](https://img2.imgtp.com/2024/04/04/1bplHCdz.png)

3. PPP的状态图

![](https://img2.imgtp.com/2024/04/04/gvFkscEH.png)

> PPP协议特点：
>
> 1. 不使用序号和确认机制，只保证无差错接收，因此是<span style="color:#ff6b6b;font-weight:bold;">不可靠服务</span>
> 2. PPP<span style="color:#ff6b6b;font-weight:bold;">只支持全双工点对点链路，不支持多点线路</span>
> 3. PPP的**两端可以运行不同的网络层协议**，但仍可使用同一个PPP进行通信
> 4. PPP是**面向字节**的，所有PPP帧的长度都是整数个字节

### 3.8 链路层设备

#### 网桥

![image-20240420155806561](https://img2.imgtp.com/2024/04/20/55lQDblM.png)

> 网桥可以**连接两个不同的网络而不增大碰撞域**

#### 交换机

![image-20240420160645782](https://img2.imgtp.com/2024/04/20/IHx13ZvA.png)

#### 集线器vs交换机

![](https://img2.imgtp.com/2024/04/04/SAdkZQI5.png)

![](https://img2.imgtp.com/2024/04/04/cH6i5koT.png)

<span style="color:#ff6b6b;font-weight:bold;">总结</span>

> 使用集线器的共享式以太网(10Mb/s)，如果有N个用户，每个用户的平均带宽为$\frac{10}{N}Mb/s$,如果使用以太网交换机（全双工）连接，每个用户平均带宽为10Mb/s，所以有N个接口的交换机总容量为10N Mb/s(半双工则减小一半),这是交换机的最大优点

![image-20240420160932053](https://img2.imgtp.com/2024/04/20/2SaXyedY.png)

### 3.9 STP

> 透明网桥的生成树协议：
>
> 为了提高以太网的可靠性,有时需要在两个以太网之间使用多个透明网桥来提供冗余链路，为了避免广播帧在环路中永久兜圈,透明网桥使用生成树协议`Spanning Tree Protocol`,可以在增加冗余链路提高网络可靠性的同时,又避免环路带来的问题

![](https://img2.imgtp.com/2024/04/04/F5cxDeoo.png)

### 4. 思维导图和习题

[第3章 数据链路层(思维导图)-1 (kdocs.cn)](https://www.kdocs.cn/view/l/cgV0rfS0qZEA)

[第3章 数据链路层(思维导图)-2 (kdocs.cn)](https://www.kdocs.cn/view/l/ciOEeLV6ffuJ)

[第3章 数据链路层(思维导图)-3 (kdocs.cn)](https://www.kdocs.cn/view/l/cnRBS8NFgTll)

[第3章 数据链路层 习题(第1部分)](https://www.kdocs.cn/view/l/cl60fYfO1qZe)

[第3章 数据链路层 习题(第2部分)](https://www.kdocs.cn/view/l/cenjHDfYLe95)

---

## 4. 网络层

### 4.1 概述

> 网络层的主要任务：将分组从源主机经过多个网络和多段链路传输到目的主机,可以将该任务划分为分组转发和路由选择两种重要的功能

### 4.2 网络层提供的两种服务

#### 1.虚电路服务

> 虚电路服务特点：
>
> 1. 虚电路提供的是<span style="color:#ff6b6b;font-weight:bold;">面向连接</span>的，<span style="color:#ff6b6b;font-weight:bold;">可靠的</span>服务
>
> 2. **虚**表示这是一条**逻辑上的连接，不是专用的**,分组沿着这条逻辑连接按照**存储转发方式传送**,而不是真正建立了一条物理连接
>
> 3. 建立连接和拆除都需要时间开销，**不适用于突发式通信，但对长时间、频繁的数据交换效率较高**
> 4. <span style="color:#ff6b6b;font-weight:bold;">致命弱点：虚电路上如果某个结点或链路出现故障(相当于电线被剪断了)，所有经过这个结点或链路的虚电路都会遭到破坏(需要重新建立连接)</span>
> 5. 分组的首部仅在连接建立阶段使用完整的目的主机地址,之后每个分组的首部只需要携带一条虚电路编号即可

![](https://img2.imgtp.com/2024/04/04/yW2dRsAm.png)

#### 2.数据报服务

> 数据报服务特点：
>
> 1. TCP/IP使用的就是这种**简单灵活**的、<span style="color:#ff6b6b;font-weight:bold;">无连接</span>的、<span style="color:#ff6b6b;font-weight:bold;">不可靠</span>的数据报服务
>
> 2. 核心思想：**可靠通信应由用户主机来保证**
>
> 3. 由于网络自身不提供端到端的可靠传输服务,这就使得网络中的**路由器可以做得比较简单,大大降低了网络造价**
>
> 4. 这种设计思想的运行方式灵活、能够适应多种应用。因特网能够发展到今日的规模,充分证明了当初采取这种设计思想的正确性

![](https://img2.imgtp.com/2024/04/04/LojBc6xi.png)

### 4.3 SDN

#### 结构

![image-20240427114506132](https://img2.imgtp.com/2024/04/27/Su0B0dOx.png)

#### 区别

> 网络层可抽象划分为**数据平面(转发)**和**控制平面(路由选择)**
>
> 传统：路由选择算法运行在每台路由器中，并且在**每台路由器中都包含转发和路由选择两种功能**
>
> (Software Defined Network，SDN)：控制平面从路由器物理上分离，**路由器仅实现转发，远程控制器计算和分发转发表以供每台路由器所使用**

#### 路由选择处理器

<img src="https://img2.imgtp.com/2024/04/27/qnHfAOU6.png" alt="image-20240427114357548" style="zoom:50%;" />

### 4.4 IPv4

#### 概述

> 网际协议(`Internet Protocol`,`IP`)是`TCP/IP`体系结构网际层中的**核心协议**
>
> `IPv4`地址就是给因特网(Internet)上的每一台主机(或路由器)的每一个接口分配一个在全世界范围内是唯一的32比特的标识符

#### 首部格式

![](https://img2.imgtp.com/2024/04/04/KOyDkDzX.png)

<span style="color:#ff6b6b;font-weight:bold;">各个字段及描述</span>

|           字段           | 描述                                                         |
| :----------------------: | :----------------------------------------------------------- |
|           版本           | 长度为4个比特,用来表示IP协议的版本,**通信双方使用的IP协议的版本必须一致**,目前广泛使用的IP协议的版本号为4(即IPv4) |
|       **首部长度**       | 长度为4个比特,该字段的取值以<span style="color:#ff6b6b;font-weight:bold;">4B为单位</span>,用来表示IPV4数据报的首部长度(**20+(0~40)**)<br/>最小取值为二进制的0101,即十进制的5,再乘以4字节单位,表示IPv4数据报首部只有20字节固定部分<br />最大取值为二进制的1111,即十进制的15,再乘以4字节单位,表示IPV4数据报首部包含20字节固定部分和最大40字节可变部分 |
|        **总长度**        | 长度为16个比特,该字段的取值以<span style="color:#ff6b6b;font-weight:bold;">字节为单位</span>,用来表示IPv4数据报的长度(首部长度+数据载荷长度)<br />最大取值为二进制的16个比特1,即十进制的65535(很少传输这么长的IPv4数据报) |
|         **标识**         | 长度为16个比特,属于**同一个IPv4数据报的各分片数据报应该具有相同的标识** |
|         **标志**         | 最低位(`More Fragment,MF`)<br/>    MF=1表示本分片后面还有分片<br/>    MF=0表示本分片后面没有分片<br/>中间位(`Don't Fragment,DF`)<br/>    DF=1表示不允许分片<br/>    DF=0表示允许分片<br/>最高位为保留位,必须设置为0 |
|        **片偏移**        | 长度为16个比特,该字段的取值,以<span style="color:#ff6b6b;font-weight:bold;">8B为单位</span>,用来指出**分片IPv4数据报的数据载荷偏移其在原IPv4数据报的位置有多远**,只能为整数,否则必须调整前一个分片长度 |
|       **生存时间**       | 长度为8个比特,最大取值为二进制的11111111,即十进制的255。该字段的取值最初以秒为单位。因此,IPv4数据报的最大生存时间最初为255秒。路由器转发IPv4数据报时,将其首部中该字段的值减去该数据报在路由器上所耗费的时间,若结果不为0就转发,否则就丢弃<br />生存时间字段后来改为<span style="color:#ff6b6b;font-weight:bold;">以“跳数”为单位</span>,路由器收到待转发的IPv4数据报时,将其首部中的该字段的值减1,若结果不为0就转发,否则就丢弃 |
|         **协议**         | 长度为8个比特,用来指明IPv4数据报的数据载荷是何种协议数据单元PDU<br />![](https://img2.imgtp.com/2024/04/04/xAa9ANsy.png) |
|      **首部检验和**      | 长度为16个比特,用于**检测IPv4数据报在传输过程中其首部是否出现了差错**<br />IPv4数据报每经过一个路由器,其首部中的某些字段的值(例如生存时间TTL、标志以及片偏移等)都可能发生变化,因此路由器都要重新计算一下首部检验和 |
| **源IP地址和目的IP地址** | 长度都为32个比特,用来填写发送(接收)IPv4数据报的源(目的)主机的IPv4地址 |

#### MTU

> `MTU`：最大传送单元,超过最大传送单元的长度的IP数据报必须分片

![](https://img2.imgtp.com/2024/04/04/L8hoyynm.png)

![](https://img2.imgtp.com/2024/04/04/al00y50P.png)



### 4.5 IP编址方式

#### 1.分类编址的IP

![](https://img2.imgtp.com/2024/04/04/qnNZ6ucM.png)

#### 2.划分子网的IP

> **分类编址方法不够灵活且容易造成大量地址浪费,划分子网编址方法对其进行改进(“打补丁”)**

<img src="https://img2.imgtp.com/2024/04/04/q2ONHMZl.png" style="zoom:80%;" />

> **划分子网案例**

<img src="https://img2.imgtp.com/2024/04/04/kwonYEUW.png" style="zoom:67%;" />

#### 3.CIDR

<img src="https://img2.imgtp.com/2024/04/04/IFbL2L2v.png" style="zoom:67%;" />

> **无分类**域间路由选择(`C`lassless `I`nter-`D`omain `R`outing,`CIDR` )

<img src="https://img2.imgtp.com/2024/04/04/2tRrZdhS.png" style="zoom:67%;" />

> **练习**

![](https://img2.imgtp.com/2024/04/04/2qpJoDAK.png)

#### 4.路由聚合

> **找出共同前缀,其余位取0**

<img src="https://img2.imgtp.com/2024/04/04/A51cUVpL.png" style="zoom:67%;" />

### 4.6 IP数据报的发送和转发过程

> **IP数据报的发送和转发过程**
>
> - **主机发送IP数据报**
>   - 判断目的主机是否与自己在同一个网络：
>     - 若在同一个网络,则属于直接交付,直接发送给目的主机
>     - 若不在同一个网络,则属于间接交付,传输给主机所在网络的默认网关(路由器),由默认网关帮忙转发)
>
> - **路由器转发IP数据报**
>   - 检查IP数据报首部是否出错：
>     - 若出错,则直接丢弃该IP数据报并通告源主机
>     - 若没有出错,则进行转发
>   - 根据IP数据报的目的地址在路由表中查找匹配的条目：
>     - 若找到匹配的条目,则转发给条目中指示的下一跳；
>     - 若找不到,则丢弃该IP数据报并通告源主机；

![](https://img2.imgtp.com/2024/04/04/Bn4bmj1L.png)

> 路由器不转发广播IP数据报,即**路由器隔离广播域**,如果因特网中数量巨大的路由器收到广播IP数据报后都进行转发,则会造成巨大的广播风暴,严重浪费因特网资源
>
> - 中继器和集线器工作在物理层,**既不隔离冲突域也不隔离广播域**
> - 网桥和交换机(多端口网桥)工作在数据链路层,**可以隔离冲突域,不能隔离广播域**
> - 路由器工作在网络层,**既隔离冲突域,也隔离广播域**



### 4.7 ARP

> ARP（Address Resolution Protocol），是**根据IP地址获取MAC地址**的一个TCP/IP协议
>
> 主机中保存了一个高速缓存表，<mark>记录了IP和MAC的对应关系</mark>

<img src="https://gitee.com/clibin/image-bed/raw/master/image-20231109221234731.png" style="zoom: 67%;" />

> ARP协议动态获取MAC地址

![](https://gitee.com/clibin/image-bed/raw/master/image-20231109221003126.png)

> **总结：`ARP`协议只能逐链路（相邻）使用，不能跨网络使用****

### 4.8 静态路由配置

#### 1. 静态路由的配置

<img src="https://img2.imgtp.com/2024/04/04/CtaIyZQk.png" style="zoom:67%;" />

#### 2. 默认路由

1. 默认路由：默认路由条目中的目的网络`0.0.0.0/0`,其中`0.0.0.0`表示任意网络,而网络前缀“/0”(相应的地址掩码为`0.0.0.0`)是最短的网络前缀

2. 特定主机路由：特定主机路由条目中的目的网络`192.168.2.1/32`,其中`192.168.2.1`是特定主机的IP地址,而网络前缀“/32”(相应地址掩码为`255.255.255.255`)是最长的网络前缀
3. 路由器在查找转发表转发IP数据报时,遵循“最长前缀匹配”的原则,因此默认路由匹配优先级最低,特定主机路由条目的匹配优先级最高

<img src="https://img2.imgtp.com/2024/04/04/ZV9GFitH.png" style="zoom:67%;" />

#### 3. 路由环路

- 错误配置静态路由有可能导致路由环路问题
- 为了防止IP数据报在环路中永久兜圈,在IP数据报首部设有生存时间TTL,TTL为0时会被丢弃

**路由环路问题产生原因：**

1. **路由配置错误**

<img src="https://img2.imgtp.com/2024/04/04/ae9r7c4U.png" style="zoom:67%;" />

2. **聚合了不存在的IP地址**

> 需要给不存在的IP地址配置黑洞路由,防止IP数据报转发到其他路由器

<img src="https://img2.imgtp.com/2024/04/04/agvaYwYw.png" style="zoom:67%;" />

3. **网络故障**

> 可以在网络发生故障时添加一条针对该IP的黑洞路由,待网络正常后又将其设置为失效状态

<img src="https://img2.imgtp.com/2024/04/04/4SIsCein.png" style="zoom: 67%;" />

### 4.9 DHCP

#### 1. 概述

> 动态主机配置协议(`D`ynamic `h`ost `c`onfiguration `p`rotocol)
>
> 作用：
>
> - `DHCP`可为计算机自动配置网络参数,包括：
>   - IP地址
>   - 子网掩码
>   - 默认网关
>   - DNS服务器

#### 2. 工作过程

![](https://img2.imgtp.com/2024/04/04/ICGzRKfp.png)

#### 3. DHCP中继代理

![](https://img2.imgtp.com/2024/04/04/Q6Dzgeuh.png)

------



### 4.10 路由选择协议

1. 路由选择分为两类

| 静态路由选择                                                 | 动态路由选择                                                 |
| :----------------------------------------------------------- | :----------------------------------------------------------- |
| 采用**人工配置**的方式给路由器添加网络路由、默认路由和特定主机路由等路由条目 | 路由器通过路由选择协议**自动获取**路由信息                   |
| 静态路由选择**简单、开销小**,但不能及时适应网络状态(流量、拓扑等)的变化 | 动态路由选择比较**复杂、开销比较大**,但能较好地适**应网络状态**的变化 |
| 静态路由选择一般只在**小规模网络**中采用                     | 动态路由选择适用于**大规模网络**                             |

2. 因特网采用分层次的路由选择协议

因特网是全球最大的互联网,它所采取的路由选择协议具有以下三个主要特点：

- 自适应：因特网采用动态路由选择,能较好地适应网络状态的变化。
- 分布式：因特网中的各路由器通过相互间的信息交互,共同完成路由信息的获取和更新。
- 分层次：将整个因特网划分为许多较小的自治系统(`Autonomous System,AS`),在自治系统内部和外部采用不同类别的路由选择协议,分别进行路由选择

<img src="https://img2.imgtp.com/2024/04/04/abaIPV0E.png" style="zoom:67%;" />

### 4.11 RIP

路由信息协议(`Routing Information Protocol,RIP`)是内部网关协议中最先得到广泛使用的协议之一

#### 概述

- RIP使用跳数(`Hop Count`)作为度量(`Metric`)来衡量到达目的网络的距离(**距离向量**)

  - RIP将路由器到直连网络的距离定义为1

  - RIP将路由器到非直连网络的距离定义为所经过的路由器数加1
  - RIP允许一条路径最多只能包含15个路由器,<span style="color:#ff6b6b;font-weight:bold;">距离等于16时相当于不可达</span>,因此RIP只适用于小型互
    联网

<img src="https://img2.imgtp.com/2024/04/04/SdAYuRNl.png" style="zoom: 50%;" />

2. RIP认为**好的路由就是“距离短”的路由**,也就是所通过路由器数量最少的路由,和传输速率和物理距离等无关

3. RIP的3个重要特点

<img src="https://img2.imgtp.com/2024/04/04/5Eskdf9i.png" style="zoom: 67%;" />

#### 工作原理

1. **基本流程**

<img src="https://img2.imgtp.com/2024/04/04/bH69GgoT.png" style="zoom:67%;" />

2. **更新规则**

<img src="https://img2.imgtp.com/2024/04/04/Fp83R5QM.png" style="zoom:80%;" />

3. **坏消息传播的慢**

   ![](https://img2.imgtp.com/2024/04/04/X8Q0gotf.png)

4. **优缺点**

| 优点                                                         | 缺点                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 实现简单,路由器开销小                                        | RIP限制了最大RIP距离为`15`这就限制了使用RIP的自治系统AS的规模 |
| 如果一个路由器发现了RIP距离更短的路由,那么这种更新信息就传播得很快,即“好消息传播得快” | 相邻路由器之间交换的路由信息是路由器中的完整路由表,因而随着网络规模的扩大,开销也随之增大 |
|                                                              | “**坏消息传播得慢**”,使更新过程的收敛时间过长。因此,对于规模较大的自治系统AS,应当使用`OSPF`协议 |

### 4.12 `OSPF`

#### 1. 基本概念

> 开放最短路径优先(`Open Shortest Path First,OSPF`)协议是为了克服路由信息协议RIP的缺点在1989年开发出来的
>
> - “开放”表明`OSPF`协议不是受某一厂商控制,而是公开发表的
> - “最短路径优先”是因为使用了Dijkstra提出的最短路径算法(`Shortest Path First,SPF`)

#### 2. 特点

> - `OSPF`是基于**链路状态**的,而不像`RIP`是基于距离向量的
> - `OSPF`基于链路状态并采用最短路径算法计算路由,从算法上保证了不会产生路由环路
> - `OSPF`不限制网络规模,更新效率高,收敛速度快

#### 3. 相关概念

1. 链路状态(`Link State,LS`)是指本路由器都和哪些路由器相邻,以及相应链路的“代价(cost)”,类似RIP中的距离

   > “代价”用来表示费用、距离、时延和带宽等,这些都由网络管理人员来决定

<img src="https://img2.imgtp.com/2024/04/04/RT6StboJ.png" style="zoom:80%;" alt='举例-思科路由器的代价计算标准' />



2. **`OSPF`路由器邻居关系的建立和维护**
   - **如果在死亡倒计时为0时还未收到邻居的问候分组,则认为该邻居不可达,**
   - **在接受到邻居的问候分组后,刷新死亡倒计时为40s**
   - **路由器每10s会向邻居发送问候分组**

<img src="https://img2.imgtp.com/2024/04/04/8vMlgEEu.png" style="zoom:67%;" />

3.  **链路状态数据库**(`Link State Database,LSDB`)

![](https://img2.imgtp.com/2024/04/04/EeKgSYgV.png)

> 使用`OSPF`的各路由器,基于链路状态数据库LSDB进行最短路径优先计算,构建出各自到达其他各路由器的最短路径,即构建各自的路由表(根据链路状态数据库得出全局带权有向图,使用Dijkstra算法得出个路由器的最短路径)

![](https://img2.imgtp.com/2024/04/04/5UrNfzxP.png)

4. **`OSPF`的五种分组类型**
   - 类型1,问候(`Hello`)分组：用来发现和维护邻居路由器的可达性。
   - 类型2,数据库描述(`Database Description`)分组：向邻居路由器给出自己的链路状态数据库中的所有链路状态项目的摘要信息
   - 类型3,链路状态请求(`Link State Request`)分组：向邻居路由器请求发送某些链路状态项目的详细信息。
   - 类型4,链路状态更新(`Link State Update`)分组：路由器使用这种分组将其链路状态进行洪泛发送,即用洪泛法对全网更新链路状态
   - 类型5,链路状态确认(`Link State Acknowledgment`)分组：这是对链路状态更新分组的确认分组。

#### 4. 基本工作原理

<img src="https://img2.imgtp.com/2024/04/04/BIoaiRjA.png" style="zoom:67%;" />

> 采用划分区域的方法,虽然使交换信息的种类增多了,同时也使OSPF协议更加复杂了,但这样做能使每一个区域内部交换路由信息的通信量大大减小,因而使OSPF协议能够用于规模更大的自治系统AS

<img src="https://img2.imgtp.com/2024/04/04/taHfWwBu.png" style="zoom:67%;" />

### 4.13  `BGP`

#### 1. 基本概念

> - **边界网关协议**(`Border Gateway Protocol,BGP`)属于外部网关协议`EGP`这个类别,用于自治系统`AS`之间的路由选择协议
> - 由于在不同AS内度量路由的“代价”(距离、带宽、费用等)可能不同,因此对于AS之间的路由选择,使用统一的“代价”作为度量来寻找最佳路由是不行的
> - AS之间的路由选择还必须考虑相关策略(政治、经济、安全等)
>
> **总结：`BGP`只能是力求寻找一条能够到达目的网络且比较好的路由(即不能兜圈子),而并非要寻找一条最佳路由**

<img src="https://img2.imgtp.com/2024/04/04/kc7UmfJ1.png" style="zoom: 80%;" />

> - 在配置BGP时,每个AS的管理员要选择至少一个路由器作为该AS的“BGP发言人”
>
> - 一般来说,两个BGP发言人都是通过一个共享网络连接在一起的,而BGP发言人往往就是BGP边界路由器
> - 使用`TCP`连接交换路由信息的两个BGP发言人,彼此称为对方的邻站(neighbor)或对等站(peer)
> - BGP发言人除了运行BGP协议外,还必须运行自己所在AS所使用的内部网关协议IGP,例如RIP或OSPF
> - BGP发言人交换网络可达性的信息,也就是要到达某个网络所要经过的一系列自治系统
> - 当BGP发言人相互交换了网络可达性的信息后,各BGP发言人就根据所采用的策略,从收到的路由信息中找出到达各自治系统的较好的路由,也就是构造出树形结构且不存在环路的自治系统连通图

#### 2. 四种报文

<img src="https://img2.imgtp.com/2024/04/04/JlA83rKF.png"  />

<img src="https://img2.imgtp.com/2024/04/04/1hHeU3jo.png"  />



### 4.14 `ICMP`

#### 1. 基本概念

> - 为了更有效地转发IP数据报以及提高IP数据报交付成功的机会,TCP/IP体系结构的网际层使用了网际控制报文协议(`Internet Control Message Protocol,ICMP`)
> - 主机或路由器使用ICMP来发送差错报告报文和询问报文
> - ICMP报文被封装在IP数据报中作为数据载荷发送

#### 2. ICMP报文数据类型

- **差错报告报文**：用来向主机或路由器报告差错情况

  - **终点不可达**：当路由器或主机不能交付IP数据报时,就向源点发送终点不可达报文,具体可再根据ICMP的代码字段细分为目的网络不可达、目的主机不可达、目的协议不可达、目的端口不可达、目的网络未知、目的主机未知等13种

    ![](https://img2.imgtp.com/2024/04/04/xmyVOhJp.png)

  - **源点抑制**：当路由器或主机由于拥塞而丢弃IP数据报时,就向发送该IP数据报的源点发送源点抑制报文,使源点知道应当把IP数据报的发送速率放慢

    <img src="https://img2.imgtp.com/2024/04/04/ImvUYf3I.png"  />

  - **超时**：

    - 当路由器收到一个目的IP地址不是自己的IP数据报时,会将其首部中生存时间TTL字段的值减1。若结果不为0,则路由器将该数据报转发出去；若结果为0,路由器不但要丢弃该数据报,还要向发送该IP数据报的源点发送时间超过(超时)报文
    - 另外,当终点在预先规定的时间内未能收到一个数据报的全部数据报分片时,就把已收到的数据报片都丢弃,也会向源点发送时间超过(超时)报文

    <img src="https://img2.imgtp.com/2024/04/04/7q3jrjnI.png"  />

  - **参数问题**：当路由器或目的主机收到IP数据报后,根据其首部中的检验和字段的值发现首部在传送过程中出现了误码,就丢弃该数据报,并向发送该数据报的源点发送参数问题报文

    ![](https://img2.imgtp.com/2024/04/04/OJVARiNr.png)

  - **改变路由(重定向)**：路由器把改变路由报文发送给主机,让主机知道下次应将IP数据报发送给另外的路由器,这样可以通过更好的路由到达目的主机

    ![](https://img2.imgtp.com/2024/04/04/iebrHMN6.png)

- **以下情况不应发送ICMP差错报告报文**：

  - 对ICMP差错报告报文不再发送ICMP差错报告报文
  - 对第一个分片的IP数据报片的所有后续数据报片都不发送ICMP差错报告报文
  - 对具有多播地址的IP数据报都不发送ICMP差错报告报文
  - 对具有特殊地址(例如`127.0.0.0`或`0.0.0.0`)的IP数据报不发送ICMP差错报告报文。

- **询问报文**：用来向主机或路由器询问情况

  - **回送请求和回答**：

    由主机或路由器向一个特定的目的主机或路由器发出。收到此报文的主机或路由器必须给发送该报文的源主机或路由器发送ICMP回送回答报文。这种询问报文用来测试目的站是否可达以及了解其有关状态

  - **时间戳请求和回答**：

    用来请求某个主机或路由器回答当前的日期和时间。在ICMP时间戳回答报文中有一个32比特的字段,其中写入的整数代表从1900年1月1日起到当前时刻一共有多少秒。这种询问报文用来进行时钟同步和测量时间

#### 3. ICMP的典型应用

##### 1. `PING`

> 分组网间探测(Packet InterNet Groper,`PING`)
>
> 在命令行中使用ping命令用来测试主机或路由器之间的连通性
>
> - PING是TCP/IP体系结构的应用层直接使用网际层ICMP的一个例子,它并不使用运输层的TCP或UDP
> - PING应用所使用的ICMP报文类型为回送请求和回答

##### 2. `traceroute`

> 跟踪路由应用traceroute,用于探测IP数据报从源主机到达目的主机要经过哪些路由器
>
> 在不同操作系统中,traceroute应用的命令和实现机制有所不同：
>
> - 在UNIX版本中,具体命令为`traceroute`,其在运输层使用UDP协议,在网络层使用ICMP报文类型只有差错报告报文
> - 在Windows版本中,具体命令为`tracert`,其应用层直接使用网际层的ICMP协议,所使用的ICMP报文类型有回送请求和回答报文以及差错报告报文
>
> **原理**：设置IP数据报TTL为1,经过第一个路由器时,TTL减为0,IP数据报被丢弃,路由器向源主机发送超时差错报告报文,这样就知道了经过的第一个路由器的IP地址,以此类推依次设置TTL为2,3,4,……,直到接收到目的主机的回送请求回答报文

### 4.15 `VPN`

> 虚拟专用网(`Virtual Private Network,VPN`)：**利用公用的因特网作为本机构各专用网之间的通信载体,这样形成的网络又称为虚拟专用网**

**专用地址**：

- `10.0.0.0-10.255.255.255`(CIDR地址块10/8)
- `172.16.0.0-172.31.255.255`(ClDR地址块172.16/12)
- `192.168.0.0-192.168.255.255`(CIDR地址块192.168/16)

> 很显然,全世界可能有很多不同机构的专用网具有相同的专用IP地址,但这并不会引起麻烦,因为这些专用地址仅在机构内部使用
>
> **注意**：在因特网中的所有路由器,对目的地址是专用地址的IP数据报一律不进行转发,这需要由因特网服务提供者ISP对其拥有的因特网路由器进行设置来实现(需要自己对路由器额外配置)

![](https://img2.imgtp.com/2024/04/04/x4VahylJ.png)

### 4.16 `NAT`

#### 1. 概述

> - **背景**：尽管因特网采用了无分类编址方法来减缓IPv4地址空间耗尽的速度,但由于因特网用户数量的急剧增长,特别是大量小型办公室和家庭网络接入因特网的需求不断增加,IPv4地址空间即将耗尽的危险然仍没有解除(实际上,因特网号码分配管理局IANN于2011年2月3日宣布,IPv4地址已经分配完毕)
>
> - **网络地址转换**(`Network Address Translation,NAT`)技术于1994年被提出,用来缓解IPv4地址空间即将耗尽的问题
>   - NAT能使大量使用内部专用地址的专用网络用户共享少量外部全球地址来访问因特网上的主机和资源
>   - 这种方法需要在专用网络连接到因特网的路由器上安装NAT软件。装有NAT软件的路由器称为NAT路由器,它至少要有一个有效的外部全球地址IPG。这样,所有使用内部专用地址的主机在和外部因特网通信时,都要在NAT路由器上将其内部专用地址转换成IPG

![](https://img2.imgtp.com/2024/04/04/jGM9Vzo8.png)

####  2. `NAPT`

> **网络地址与端口号转换方法**:将NAT和运输层端口号结合使用,称为网络地址与端口号转换(`Network Address and Port Translation,NAPT`)
>
> - 由于目前绝大多数基于TCP/IP协议栈的网络应用,都使用运输层的传输控制协议TCP或用户数据报协议UDP,为了更加有效地利用NAT路由器中的全球IP地址,现在常将NAT转换和运输层端口号结合使用
>   - 这样就可以使内部专用网中使用专用地址的大量主机,共用NAT路由器上的1个全球IP地址,因而可以同时与因特网中的不同主机进行通信
>   - 现在很多家用路由器将家中各种智能设备(手机、平板、笔记本电脑、台式电脑、物联网设备等)接入因特网,这种路由器实际上就是一个NAPT路由器,但往往并不运行路由选择协议

![](https://img2.imgtp.com/2024/04/04/pXcz3mVQ.png)

> 由于NAT对外网屏蔽了内网主机的网络地址,能为内网的主机提供一定的安全保护

### 5. 思维导图和习题

[第4章 网络层(思维导图)-1 (kdocs.cn)](https://www.kdocs.cn/view/l/ceLxGZ0br8Gy)

[第4章 网络层(思维导图)-2 (kdocs.cn)](https://www.kdocs.cn/view/l/cu2tek1gzIPq)

[第4章 网络层(思维导图)-3 (kdocs.cn)](https://www.kdocs.cn/view/l/cjXVALCjxr0X)

[第4章 网络层(思维导图)-4 (kdocs.cn)](https://www.kdocs.cn/view/l/cbSlBNdR8CSr)

[第4章 网络层 习题(第1部分)](https://www.kdocs.cn/view/l/ccu9ATsOpoZf)

[第4章 网络层 习题(第2部分)](https://www.kdocs.cn/view/l/cqBldcygudFg)

---

## 5. 运输层

### 1. 概述

- 第2~4章依次介绍了计算机网络体系结构中的物理层、数据链路层和网络层,它们共同解决了将主机通过异构网络互联起来所面临的问题,实现了主机到主机的通信
- 然而在计算机网络中实际进行通信的真正实体,是位于通信两端主机中的进程
- 如何**为运行在不同主机上的应用进程提供直接的逻辑通信服务**,就是运输层的主要任务,运输层协议又称为端到端协议

![](https://img2.imgtp.com/2024/04/04/D2rQouVM.png)

### 2. 端口号,复用和分用

#### 1. 运输层端口号

- 运行在计算机上的进程是使用进程标识符(`P`rocess `ld`entification,`PID`)来标识的。
  - 然而,因特网上的计算机并不是使用统一的操作系统,而不同操作系统(Windows、Linux、.MacOS)
    又使用不同格式的进程标识符
  - 为了使运行不同操作系统的计算机的应用进程之间能够基于网络进行通信,就必须使用统一的方法
    对TCPP体系的应用进程进行标识
- `TCP/IP`体系结构的运输层使用端口号来标识和区分应用层的不同应用进程。端口号的长度为6比特,取
  值范围是0~65535

<img src="https://img2.imgtp.com/2024/04/04/LEoAKn42.png" style="zoom:100%;" />

> **端口号只具有本地意义,即端口号只是为了标识本计算机网络协议栈应用层中的各应用进程。在因特网中,不同计算机中的相同端口号是没有关系的,即相互独立。另外,`TCP`和`UDP`端口号之间也是没有关系的**

#### 2. 发送方的复用和接收方的分用

1. **复用(Multiplexing)：**
   - **定义：** 复用是指将多个应用程序的数据流合并到一个共享的通信通道上
   - **TCP中的复用：** 在TCP中,复用通过源端口号来实现。TCP连接的两端使用IP地址和端口号来唯一标识。源端口号表示发送端的应用程序,目的端口号表示接收端的应用程序。这样,在单个TCP连接中,多个应用程序的数据可以共享同一个物理通信通道
   - **UDP中的复用：** 在UDP中,复用同样通过源端口号来实现。UDP报文的源端口号用于标识发送端的应用程序,目的端口号用于标识接收端的应用程序
2. **分用(Demultiplexing)：**
   - **定义：** 分用是指根据数据流中的标识信息将合并的数据流分发给正确的应用程序
   - **TCP中的分用：** 在TCP中,分用通过目的端口号来实现。接收端根据目的端口号将接收到的数据分发给相应的应用程序。这样,TCP层能够将数据正确地传递给目标应用程序
   - **UDP中的分用：** 在UDP中,同样通过目的端口号来实现分用。接收端通过目的端口号确定应该将数据交付给哪个应用程序

![](https://img2.imgtp.com/2024/04/04/HKhQUmCb.png)

> 常见协议的分类

![](https://img2.imgtp.com/2024/04/04/ioR9SdPa.png)

**<a href='https://www.bilibili.com/video/BV1c4411d7jb?t=353.6&p=58'>运输层端口号应用举例</a>**



### 3.  `TCP`和`UDP`的对比

![](https://img2.imgtp.com/2024/04/04/8ufoDA1F.png)

**注意**：

- TCP面向连接是逻辑连接,并非真实物理连接
- TCP面向字节流,UDP面向应用报文(只是给数据报添加一个UDP首部)
- TCP只支持单播,UDP支持单播、多播和广播
- TCP提供可靠服务,UDP提供不可靠服务

### 4. TCP的**流量控制**

#### 1. 概述

> TCP为应用程序提供了流量控制(`Flow Control`)机制,以解决因发送方发送数据太快而导致接收方来不及接收,造成接收方的接收缓存溢出的问题
>
> **流量控制的基本方法：**接收方根据自己的接收能力(接收缓存的可用空间大小)控制发送方的发送速率

#### 2. <a href='https://www.bilibili.com/video/BV1c4411d7jb?t=44.1&p=60'>流量控制方法</a>

1. **流程**

![](https://img2.imgtp.com/2024/04/04/W4mjWAtQ.png)

![](https://img2.imgtp.com/2024/04/04/3DCPrqks.png)

2. 例题

   ![](https://img2.imgtp.com/2024/04/04/eYiMYvRR.png)

### 5. TCP的**拥塞(se)控制**

#### 1. 基本概念

<img src="https://img2.imgtp.com/2024/04/04/xL1bNfCp.png" />

#### 2. 4种拥塞控制方法

![](https://img2.imgtp.com/2024/04/04/v0EQTjNj.png)

##### 1. 慢开始、拥塞避免

![](https://img2.imgtp.com/2024/04/04/1mqfBCfM.png)

##### 2. 快重传、快恢复

> <font>快重传算法</font>和快恢复算法(改进TCP性能,1990年Reno版本)

1. 问题

![](https://img2.imgtp.com/2024/04/04/MiKI7G2d.png)

2. **快重传**

   - **采用快重传算法可以让发送方尽早知道发生了个别TCP报文段的丢失**
   - “快重传”是指**使发送方尽快(尽早)进行重传,而不是等重传计时器超时再重传**
     - 这就要求接收方不要等待自己发送数据时才进行捎带确认,而是要立即发送确认,即使收到了失序的报文段也要立即发出对已收到的报文段的重复确认
     - 发送方一旦收到3个连续的重复确认,就将相应的报文段立即重传,而不是等该报文段的重传计时器超时再重传

   ![](https://img2.imgtp.com/2024/04/04/xkVEdIRO.png)

3. **快恢复**

> 与快重传算法配合使用的是**快恢复算法**,发送方一旦收到3个重复确认,就知道现在只是丢失了个别的报文段,于是不启动慢开始算法,**而是执行快恢复算法**
>
> - **快恢复算法：**发送方将慢开始门限ssthresh的值和拥塞窗口cwnd的值**都调整为当前cwnd值的一半**,并开始执行拥塞避免算法
> - 也有的快恢复实现是把快恢复开始时的cwnd值再增大一些,即cwnd=新ssthresh+3

![](https://img2.imgtp.com/2024/04/04/qO3uhLLl.png)

### 6. TCP超时重传时间的选择

> **TCP超时重传时间RTO的选择是TCP最复杂的问题之一**
>
> 问题：
>
> - 超时重传时间设置过小,在确认报文段发送给接收方的过程中,发送方重传数据报文,增大了网络负荷
> - 超时重传时间设置过大,需要重传数据报文时,推迟时间太长,网络空闲时间大,降低了传输效率
> - 超时重传时间`RTO`应略大于往返时间`RTT`

#### **RTO的选择**

##### 1. RTTs的计算

![](https://img2.imgtp.com/2024/04/04/UDFqDvXR.png)

##### 2. RRTd和RTO的计算

![](https://img2.imgtp.com/2024/04/04/HY1BAdru.png)

#### 发生超时重传时无法测准RTT

![](https://img2.imgtp.com/2024/04/04/yNzUzb2Y.png)

> **通过上述两个例子可以看出：当发送方出现超时重传后,收到确认报文段时是无法判断出该确认到底是对原数据报文段的确认还是对重传数据报文段的确认,也就是无法准确测量出RTT,进而无法正确计算RTO**

##### Karn算法及修正

![](https://img2.imgtp.com/2024/04/04/AwbzanjU.png)

##### 总结

![](https://img2.imgtp.com/2024/04/04/xrIJQlOc.png)

### 7.TCP可靠传输的实现

- **TCP的窗口以字节为单位**

![](https://img2.imgtp.com/2024/04/04/YjEPy8k0.png)

- 发送方
  - 发送窗口内的已发送数据如果迟迟未收到确认,会发生超时重传
  - 只有处于发送窗口内的数据才能发送

![](https://img2.imgtp.com/2024/04/04/fR0t7TXv.png)

- 接收方
  - 接收方**只能对按序收到的数据中的最高序号给出累计确认**,3次重复确认会导致发送方**快重传**
  - **序号落入接收窗口内的数据是允许接收的数据**

![](https://img2.imgtp.com/2024/04/04/i29w36GO.png)

- **总结**

![](https://img2.imgtp.com/2024/04/04/or468nHg.png)

### 8. TCP的运输连接管理

#### 1. TCP连接的建立

![](https://img2.imgtp.com/2024/04/04/J2XMeS5i.png)

> TCP双方连接的建立要解决的三个问题

![](https://img2.imgtp.com/2024/04/04/unn0sUEo.png)

#### 2. 三报文握手

![](https://img2.imgtp.com/2024/04/04/LViPPUEp.png)

> **思考：第三次确认是否多余,能不能两报文握手？**
>
> 答案：不能,如下图所示

![](https://img2.imgtp.com/2024/04/04/ubh3gJLp.png)

#### 3. 四报文挥手

![](https://img2.imgtp.com/2024/04/04/80yAaiIl.png)

> **思考：为什么客户端发送完最后一个确认报文段后不立刻关闭而是等待2个MSL时间后才关闭？**
>
> 答案：如图所示

![](https://img2.imgtp.com/2024/04/04/G3BFV47H.png)

> TCP保活计时器的作用

![](https://img2.imgtp.com/2024/04/04/xivu7oAV.png)

### 9. TCP报文段首部格式

> 参阅思维导图 1

### 10. 思维导图和习题

[第5章 运输层(思维导图)-1 (kdocs.cn)](https://www.kdocs.cn/view/l/cgoja6Lpohhj)

[第5章 运输层(思维导图)-2 (kdocs.cn)](https://www.kdocs.cn/view/l/chkSS9vn9Zgd)

[第5章 运输层 习题 (kdocs.cn)](https://www.kdocs.cn/view/l/cpaRQtp0G6Ou)

---

## 6. 应用层

### 1. 概述

- 应用层是计算机网络体系结构的**最顶层**,是**设计和建立计算机网络的最终目的**,也是计算机网络中发展最快的部分
  - 早期基于文本的应用(电子邮件、远程登录、文件传输、新闻组)
  - 20世纪90年代将因特网带入千家万户的万维网WWW
  - 当今流行的即时通信、P2P文件共享及各种音视频应用
  - 计算设备的小型化和“无处不在”,宽带住宅接入和无线接入的日益普及和迅速发展,为未来更多的新型应用提供了广阔的舞台

### 2. 客户服务器和对等方式

#### 1. `C/S`方式

![](https://img2.imgtp.com/2024/04/04/N4aLVqmQ.png)

![](https://img2.imgtp.com/2024/04/04/lXMm63X5.png)

#### 2. `P2P`方式

![](https://img2.imgtp.com/2024/04/04/Vj0hHf1g.png)

![](https://img2.imgtp.com/2024/04/04/yAx2AVuq.png)



### 4. `DNS`

> **域名系统**(`D`omain `N`ame `S`ystem,`DNS`)

#### 1. 域名系统的作用

![](https://img2.imgtp.com/2024/04/04/gBFxses1.png)

![](https://img2.imgtp.com/2024/04/04/x1tUx2vm.png)

#### 2. 因特网的域名结构

> 因特网采用**层次树状结构的域名结构**

##### 1. 域名规范

![](https://img2.imgtp.com/2024/04/04/AoFgDCmt.png)

##### 2. 不同国家的域名

![](https://img2.imgtp.com/2024/04/04/6WUpB9Oh.png)

##### 3. 因特网的域名空间

![](https://img2.imgtp.com/2024/04/04/rBS3t5ef.png)

#### 3. 域名服务器

![](https://img2.imgtp.com/2024/04/04/zLHYxWek.png)

#### 4. 域名解析

##### 1. 递归查询

![](https://img2.imgtp.com/2024/04/04/FpBrwNqb.png)

##### 2. 迭代查询

![](https://img2.imgtp.com/2024/04/04/nQ6sAl2O.png)

##### 3. 高速缓存

![](https://img2.imgtp.com/2024/04/04/pcwXhKnx.png)

![](https://img2.imgtp.com/2024/04/04/8BLUzbFZ.png)

### 5. `FTP`

> **文件传送协议**(`F`ile `T`ransfer `P`rotocol,`FTP`)

![](https://img2.imgtp.com/2024/04/04/83gndWFQ.png)

> **基本工作原理**

1. 主动模式

![](https://img2.imgtp.com/2024/04/04/zIeZrtFX.png)

2. 被动模式

![](https://img2.imgtp.com/2024/04/04/Gm7FBUWz.png)

### 6. 电子邮件

#### 1. `E-mail`

![](https://img2.imgtp.com/2024/04/04/dRoMrTBk.png)

#### 2. 电子邮件系统的组成

![](https://img2.imgtp.com/2024/04/04/bK0zdDmM.png)

#### 3. 邮件发送和接收过程

![](https://img2.imgtp.com/2024/04/04/D9l7k3yg.png)

#### 4. `SMTP`

> 简单邮件传送协议(Simple Mail Transfer Protocol,`SMTP`)的基本工作过程

![](https://img2.imgtp.com/2024/04/04/DMl68A1m.png)

#### 5. 电子邮件的信息格式

![](https://img2.imgtp.com/2024/04/04/mMKxiFqt.png)

#### 6. `MIME`

> **多用途因特网邮件扩展** (Multipurpose Internet Mail Extensions,`MIME`)

![](https://img2.imgtp.com/2024/04/04/l34rdKif.png)

> **`MIME`对邮件内容中的非ASCII字符转换成ASCII字符**

![](https://img2.imgtp.com/2024/04/04/GwUXUJEh.png)

#### 7. 常用邮件读取协议

> **邮局协议**(Post Office Protocol,`POP`)
>
> **因特网邮件访问协议**(Internet Message Access Protocol,`IMAP`)

![](https://img2.imgtp.com/2024/04/04/2e8zsrXX.png)

#### 8. 基于万维网的电子邮件

![](https://img2.imgtp.com/2024/04/04/qYWywPpx.png)

### 7. 万维网

#### 1. 概述

> - **万维网**(World Wide Web,`WWW`)并非某种特殊的计算机网络。它是一个大规模的、联机式的信息储藏所,是运行在因特网上的一个分布式应用
> - 万维网利用网页之间的超链接将不同网站的网页链接成一张逻辑上的信息网
> - 万维网是欧洲粒子物理实验室的Tim Berners-Lee最初于1989年3月提出的

#### 2. `URL`

> 统一资源定位符(`U`niform `R`esource `L`ocator)

![image-20231205094301978](https://img2.imgtp.com/2024/04/04/pQNu9Io6.png)

#### 3. 万维网文档

![](https://img2.imgtp.com/2024/04/04/MEItS0Eb.png)

#### 4. `HTTP`

##### 1. 概述

> **超文本传输协议**`HTTP`(HyperText Transfer Protocol)
>
> HTTP定义了**浏览器(即万维网客户进程)怎样向万维网服务器请求万维网文档,以及万维网服务器怎样把万维网文档传送给浏览器**

![](https://img2.imgtp.com/2024/04/04/MilI8kKE.png)

##### 2. 报文格式

- 请求报文格式

![](https://img2.imgtp.com/2024/04/04/lj3eU4LR.png)

- 响应报文格式

![](https://img2.imgtp.com/2024/04/04/8CMJ8OdG.png)

#### 5. `Cookie`

- 早期的万维网应用非常简单,仅仅是用户查看存放在不同服务器上的各种静态的文档。因此HTTP被设计为一种无状态的协议。这样可以简化服务器的设计
- 现在,用户可以通过万维网进行各种复杂的应用,如网上购物、电子商务等。这些应用往往需要万维网服务器能够识别用户
- Cookie提供了一种机制使得万维网服务器能够“记住”用户,而无需用户主动提供用户标识信息。也就是说,Cookie是一种对无状态的HTTP进行状态化的技术

![](https://img2.imgtp.com/2024/04/04/jdF402Xf.png)

#### 6. 万维网缓存与代理服务器

![](https://img2.imgtp.com/2024/04/04/TH8yLUXM.png)

#### 7. 思维导图和相关习题

[第6章 应用层(思维导图)-1 (kdocs.cn)](https://www.kdocs.cn/view/l/cle5dxMBHZIH)

[第6章 应用层(思维导图)-2 (kdocs.cn)](https://www.kdocs.cn/view/l/cabHsokbKiNO)

[第6章 应用层 习题 (kdocs.cn)](https://www.kdocs.cn/view/l/cv9vfzDopPvi)

---

## *计算机网络相关术语*

**ACK** (Acknowledgement) 确认

**ADSL** (Asymmetric Digital Subscriber Line) 非对称数字用户线

**AP** (Access Point) 接入点

**AP** (Application) 应用程序

**API** (Application Programming Interface) 应用编程接口

**APNIC** (Asia Pacific Network Information Centre) 亚太网络信息中心

**ARIN** (American Registry for Internet Numbers) 美国因特网号码注册机构

**ARP (Address Resolution Protocol) 地址解析协议**

**ARPA** (Advanced Research Projects Agency) 美国国防部远景研究规划局 (高级研究计划署) 

**ARQ** (Automatic Repeat-request) 自动重传请求

**AS** (autonomous system) 自制系统

**BGP** (Border Gateway Protocol ) 边界网关协议

**BOOTP** (Bootstrap Protocol) 引导程序协议

**BSA** (Basic Service Area) 基本服务区

**BT** (Bit Torrent) 一种P2P程序

**CA** (Certificate Authority) 认证中心

**CA** (Collision Avoidance) 碰撞避免

**CATV** ( Community Antenna Television) 有线电视

**CDM** (Code Division Multiplexing) 码分复用

**CDMA** (Code Division Multiple Access) 码分多址

**CGI**  (Common Gateway Interface) 通用网关接口

**CIDR** (Classless Inter-Domain Routing) 无分类域间路由选择

**CRC** (Cyclic Redundancy Check) 循环冗余校验

**CSMA/CD** (Carrier Sense Multiple Access/Collision Detect) 载波监听 多址接入/碰撞检测

**CSMA/CA** (Carrier Sense Multiple Access with Collision Avoidance)  载波监听多点接入/冲突避免

**CTS** (Clear To Send) 允许发送

**DACS** (Digital Access and Cross-connect System) 数字交接系统

**DHCP (Dynamic Host Configuration Protocol) 动态主机配置协议**

**DiffServ (Differentiated Services) 区分服务**

**DLCI** (Data Link Connection Identifier) 数据链路连接标识符

**DMT** (Discrete Multi-Tone) 离散多音 (调制) 

**DNS** (Domain Name System) 域名系统

**DoS** (Denial of Service) 拒绝服务

**DS** (Distribution System) 分配系统

**DSL** (Digital Subscriber Line) 数字用户线

**DSLAM** ( DSL Access Multiplexer) 数字用户线接入复用器

**DSSS** (Direct Sequence Spread Spectrum) 直接序列扩频

**EFM** (Ethernet in the First Mile ) 第一英里的以太网

**EFPHB** (Expedited Forwarding Per-Hop Behavior) 迅速转发每跳行为

**EGP** (Exterior Gateway Protocol) 外部网关协议

**EIA** (Electronic Industries Association) 美国电子工业协会

**FCS** (Frame Check Sequence) 帧检验序列

**FDDI** (fiber-distributed data interface) 光纤分布式数据接口

**FDM** (Frequency-division multiplexing) 频分复用

**FEC** (Forwarding Equivalence Class) 转发等价类

**FFD** (Full-Function Device) 全功能设备

**FHSS** (Frequency-Hopping Spread Spectrum) 跳频扩频

**FIFO** (First In First Out) 先进先出

**FQ** (Fair Queuing) 公平排队

**FTP (File Transfer Protocol) 文件传输协议**

**GIF** (Graphics System for Mobile) 全球移动通信系统,GSM体制

**HDLC** ( High-Level Data Link Control) 高级数据链路控制

**HDSL** (High-speed DSL) 高速数字用户线

**HSSG** (High Speed Study Group) 高速研究组

**HTML** (Hyper Text Markup Language) 超文本标记语言

**HTTP (Hyper Text Transfer Protocol) 超文本传送协议**

**IAB** (Internet Architecture Board) 因特网体系结构委员

**IANA** (Internet Assigned Numbers Authority) 因特网赋号管理局

**ICMP (Internet Control Message Protocol) 网际控制报文协议**

**IEEE** (Institute of Electrical and Electronic Engineering) (美国) 电气和电子工程师学会

**IFS** (Inter Frame Space) 帧间间隔

**IGMP** (Internet Group Management Protocol) 网际组管理协议

**IGP** (Interior Gateway Protocol) 内部网关协议

**IM** (Instant Messaging) 及时传信

**IMAP ( Internet Message Access Protocol) 因特网报文存取协议**

**IntServ** (Integrated Services) 综合服务

**IP (Internet Protocol) 网际协议**

**IPCP** (IP Control Protocol) IP控制协议

**IPng** (IP Next Protocol) 下一代IP

**IPsec** (IP security) IP安全协议

**ISDN** (Internet Services Digital Network) 综合业务数字网

**ISO** (International Organization for Standardization ) 国际标准化组织

**ISOC** (Internet Society) 因特网协会

**ISP** (Internet Service Provider) 因特网服务提供者

**LAN** (Local Area Network) 局域网

**LCP** (Link Control Protocol) 链路控制协议

**LDP** (Label Distribution Protocol) 标记分配协议

**LLC**(Logical Link Control) 逻辑链路控制

**LSR**(Label Switched Router) 标记交换路由器

**MAC**(Medium Access Control) 媒体接入控制

**MACA**(Multiple Access with Collision Avoidance)具有碰撞避免的多点接入

**MAN**(Metropolitan Area Network) 城域网

**MBONE**(Multicast Backbone On the InterNet) 多播主干网

**MCU**(Multipoint Control Unit) 多点控制单元

**MD**(Message Digest) 报文摘要

**MF**(More Fragment) 还有分片

**MRU**(Maximum Receive Unit) 最大接收单元

**MSS**(Maximum Segment Size) 最长报文段

**MTU**(Maximum Transfer Unit) 最大传送单元

**NAP**(Network Access Point)　网络接入点

**NAT**(Network Address Translation) 网络地址转换

**NAV**(Network Allocation Vector) 网络分配向量

**NCP**(Network Control Protocol) 网络控制协议

**NFS**(Network File System) 网络文件系统

**NOC**(Network Operations Center) 网络运行中心

**NSAP**(Network Service Access Point) 网络层服务访问点

**NSF**(National Service Foundation) (美国)国家科学基金会

**OFDM**(Orthogonal Frequency Division Multiplexing) 正交频分复用

**OSI/RM** (Open Systems Interconnection Reference Model) 开发系统互连基本参考模型

**OSPF(Open Shortest Path First) 开放最短通路优先**

**P2P**(Peer-to-Peer) 对等方式

**PAN**(Personal Area Network) 个人区域网

**PAP**(Password Authentication Protocol) 口令鉴别协议

**PCA**(Policy Certification Authority) 政策认证中心

**PCF**(Point Coordination Function) 点协调功能

**PCM**(Pulse Code Modulation) 脉码调制

**PEM**(Privacy Enhanced Mail) 因特网的正式邮件加密标准

**PGP**(Pretty Good Privacy) 一种电子邮件的机密标准

**PHB**(Per-Hop Behavior) 每跳行为

**PIFS**(Point Coordination Function IFS) 点协调功能帧间间隔

**PK**(public key) 公钥,公开密钥

**PoP**(Point of Presence) 汇接点

**POP**(Post Office Protocol) 邮局协议

**PPP(Point-to-Point Protocol) 点对点协议**

**PPPoE**(Point-to-Point Protocol over Ethernet) 以太网上的点对点协议

**QAM**(Quadrature Amplitude Modulation) 正交幅度调制

**QoS**(Quality of Service)　服务质量

**QPSK**(Quarternary Phase Shift Keying)正交相移键控

**RARP**(Reverse Address Resolution Protocol)逆地址解析协议

**RFD**(Reduced-Function Device)精简功能设备

**RG**(Research Group)研究组

**RIP(Routing Information Protocol)路由信息协议**

**RIPE**(法文表示的European IP Network)欧洲的IP 网络

**RTP**(Real-Time Transfer Protocol)实时传送协议

**RTSP**(Real-Time Streaming Protocol)实时流式协议

**RTT**(Round-Trip Time)往返时间

**SA**(Security Association)安全关联

**SACK**(Selective ACK)选择确认

**SAP**(Service Access Point)服务访问点

**SCTP**(Stream Control Transmission Protocol)流控制传输协议

**SDH**(Synchronous Digital Hierarchy)同步数字系列

**SMI**(Structure of Management Information)管理信息结构

**SMTP(Simple Mail Transfer Protocol)简单邮件传送协议**

**SNA**(System Network Architecture)系统网络体系结构

**SNMP**(Simple Network Management Protocol)简单网络管理协议

**SOH**(Start Of Header)首部开始

**SONET**(Synchronous Optical Network)同步光纤网

**STDM**(Statistic TDM)统计时分复用

**STM**(Synchronous Transfer Module)同步传递模块

**STS**(Synchronous Transport Signal)同步传送信号

**TAG**(TAG Switching)标记交换

**TCB**(Transmission Control Block)传输控制程序块

**TCP(Transmission Control Protocol)传输控制协议**

**TDM**(Time Division Multiplexing)时分复用

**TELNET**(TELetype NETwork)电传机网络,一种因特网的应用程序

**TFTP**(Trivial File Transfer Protocol)简单文件传送协议

**TIA**(Telecommunications Industries Association)电信行业协会

**TLD**(Top Level Domain)顶级域名

**TLI**(Transport Layer Interface)运输层接口

**TLS**(Transport Layer Security)运输层安全协议

**TLV**(Type-Length-Value)类型-长度-值

**TPDU**(Transport Protocol Data Unit)运输协议数据单元

**UDP(User Datagram Protocol)用户数据报协议**

**URL**(Uniform Resource Locator)统一资源定位符

**UTP**(Unshield Twisted Pair)无屏蔽双绞线

**UWB**(Ultra-Wide Band)超宽带

**VC**(Virtual Circuit)虚电路

**VDSL**(Very high speed DSL)甚高数字用户线

**VLAN**(Virtual LAN)虚拟局域网

**VPN**(Virtual Private Network) 虚拟专用网

**WAN**(Wide Area Network) 广域网

**WDM**(Wavelength Division Multiplexing) 波分复用

**WG**(Working Group)　工作组

**Ｗi-Fi**(Wireless-Fidelity) 无线保真度(无限局域网的同义词)

**WLAN**(Wireless Local Area Network) 无线局域网

**WMAN**(Wireless Metrpolitan Area Network) 无线个城域网

**WPAN**(wireless Personal Area Network) 无线个人区域网

**WSN**(Wireless Sensor Network)　无线传感器网络

**WWW**(World Wide Web) 万维网



## *脚注*

[^ISP]:`internet service provider` 互联网服务提供商(电信、移动、联通)
[^ACK]:ACK是TCP/IP协议中的一个重要标志,表示"确认"(Acknowledgement)
[^ALOHA]:ALOHA是夏威夷人表示致意的问候语,这项研究计划的目的是要解决夏威夷群岛之间的通信问题





## 待用图片

ARP

![](https://img2.imgtp.com/2024/04/04/lsOMhMkC.png)
<!--stackedit_data:
eyJoaXN0b3J5IjpbNDUxNDg1MTY5XX0=
-->